/*!
 * jQuery UI 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
/*!
 * jQuery UI 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(c,j){function k(a){return!c(a).parents().andSelf().filter(function(){return c.curCSS(this,"visibility")==="hidden"||c.expr.filters.hidden(this)}).length}c.ui=c.ui||{};if(!c.ui.version){c.extend(c.ui,{version:"1.8.11",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,
NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});c.fn.extend({_focus:c.fn.focus,focus:function(a,b){return typeof a==="number"?this.each(function(){var d=this;setTimeout(function(){c(d).focus();b&&b.call(d)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;a=c.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(c.curCSS(this,
"position",1))&&/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?c(document):a},zIndex:function(a){if(a!==j)return this.css("zIndex",a);if(this.length){a=c(this[0]);for(var b;a.length&&a[0]!==document;){b=a.css("position");
if(b==="absolute"||b==="relative"||b==="fixed"){b=parseInt(a.css("zIndex"),10);if(!isNaN(b)&&b!==0)return b}a=a.parent()}}return 0},disableSelection:function(){return this.bind((c.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});c.each(["Width","Height"],function(a,b){function d(f,g,l,m){c.each(e,function(){g-=parseFloat(c.curCSS(f,"padding"+this,true))||0;if(l)g-=parseFloat(c.curCSS(f,
"border"+this+"Width",true))||0;if(m)g-=parseFloat(c.curCSS(f,"margin"+this,true))||0});return g}var e=b==="Width"?["Left","Right"]:["Top","Bottom"],h=b.toLowerCase(),i={innerWidth:c.fn.innerWidth,innerHeight:c.fn.innerHeight,outerWidth:c.fn.outerWidth,outerHeight:c.fn.outerHeight};c.fn["inner"+b]=function(f){if(f===j)return i["inner"+b].call(this);return this.each(function(){c(this).css(h,d(this,f)+"px")})};c.fn["outer"+b]=function(f,g){if(typeof f!=="number")return i["outer"+b].call(this,f);return this.each(function(){c(this).css(h,
d(this,f,true,g)+"px")})}});c.extend(c.expr[":"],{data:function(a,b,d){return!!c.data(a,d[3])},focusable:function(a){var b=a.nodeName.toLowerCase(),d=c.attr(a,"tabindex");if("area"===b){b=a.parentNode;d=b.name;if(!a.href||!d||b.nodeName.toLowerCase()!=="map")return false;a=c("img[usemap=#"+d+"]")[0];return!!a&&k(a)}return(/input|select|textarea|button|object/.test(b)?!a.disabled:"a"==b?a.href||!isNaN(d):!isNaN(d))&&k(a)},tabbable:function(a){var b=c.attr(a,"tabindex");return(isNaN(b)||b>=0)&&c(a).is(":focusable")}});
c(function(){var a=document.body,b=a.appendChild(b=document.createElement("div"));c.extend(b.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});c.support.minHeight=b.offsetHeight===100;c.support.selectstart="onselectstart"in b;a.removeChild(b).style.display="none"});c.extend(c.ui,{plugin:{add:function(a,b,d){a=c.ui[a].prototype;for(var e in d){a.plugins[e]=a.plugins[e]||[];a.plugins[e].push([b,d[e]])}},call:function(a,b,d){if((b=a.plugins[b])&&a.element[0].parentNode)for(var e=0;e<b.length;e++)a.options[b[e][0]]&&
b[e][1].apply(a.element,d)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(a,b){if(c(a).css("overflow")==="hidden")return false;b=b&&b==="left"?"scrollLeft":"scrollTop";var d=false;if(a[b]>0)return true;a[b]=1;d=a[b]>0;a[b]=0;return d},isOverAxis:function(a,b,d){return a>b&&a<b+d},isOver:function(a,b,d,e,h,i){return c.ui.isOverAxis(a,d,h)&&c.ui.isOverAxis(b,e,i)}})}})(jQuery);
;/*!
 * jQuery UI Widget 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(b,j){if(b.cleanData){var k=b.cleanData;b.cleanData=function(a){for(var c=0,d;(d=a[c])!=null;c++)b(d).triggerHandler("remove");k(a)}}else{var l=b.fn.remove;b.fn.remove=function(a,c){return this.each(function(){if(!c)if(!a||b.filter(a,[this]).length)b("*",this).add([this]).each(function(){b(this).triggerHandler("remove")});return l.call(b(this),a,c)})}}b.widget=function(a,c,d){var e=a.split(".")[0],f;a=a.split(".")[1];f=e+"-"+a;if(!d){d=c;c=b.Widget}b.expr[":"][f]=function(h){return!!b.data(h,
a)};b[e]=b[e]||{};b[e][a]=function(h,g){arguments.length&&this._createWidget(h,g)};c=new c;c.options=b.extend(true,{},c.options);b[e][a].prototype=b.extend(true,c,{namespace:e,widgetName:a,widgetEventPrefix:b[e][a].prototype.widgetEventPrefix||a,widgetBaseClass:f},d);b.widget.bridge(a,b[e][a])};b.widget.bridge=function(a,c){b.fn[a]=function(d){var e=typeof d==="string",f=Array.prototype.slice.call(arguments,1),h=this;d=!e&&f.length?b.extend.apply(null,[true,d].concat(f)):d;if(e&&d.charAt(0)==="_")return h;
e?this.each(function(){var g=b.data(this,a),i=g&&b.isFunction(g[d])?g[d].apply(g,f):g;if(i!==g&&i!==j){h=i;return false}}):this.each(function(){var g=b.data(this,a);g?g.option(d||{})._init():b.data(this,a,new c(d,this))});return h}};b.Widget=function(a,c){arguments.length&&this._createWidget(a,c)};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(a,c){b.data(c,this.widgetName,this);this.element=b(c);this.options=b.extend(true,{},this.options,
this._getCreateOptions(),a);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},
widget:function(){return this.element},option:function(a,c){var d=a;if(arguments.length===0)return b.extend({},this.options);if(typeof a==="string"){if(c===j)return this.options[a];d={};d[a]=c}this._setOptions(d);return this},_setOptions:function(a){var c=this;b.each(a,function(d,e){c._setOption(d,e)});return this},_setOption:function(a,c){this.options[a]=c;if(a==="disabled")this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",c);return this},
enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(a,c,d){var e=this.options[a];c=b.Event(c);c.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();d=d||{};if(c.originalEvent){a=b.event.props.length;for(var f;a;){f=b.event.props[--a];c[f]=c.originalEvent[f]}}this.element.trigger(c,d);return!(b.isFunction(e)&&e.call(this.element[0],c,d)===false||c.isDefaultPrevented())}}})(jQuery);
;/*!
 * jQuery UI Mouse 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(b){b.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(c){return a._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(true===b.data(c.target,a.widgetName+".preventClickEvent")){b.removeData(c.target,a.widgetName+".preventClickEvent");c.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(a){a.originalEvent=
a.originalEvent||{};if(!a.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(a);this._mouseDownEvent=a;var c=this,e=a.which==1,f=typeof this.options.cancel=="string"?b(a.target).parents().add(a.target).filter(this.options.cancel).length:false;if(!e||f||!this._mouseCapture(a))return true;this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet)this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=true},this.options.delay);if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)){this._mouseStarted=
this._mouseStart(a)!==false;if(!this._mouseStarted){a.preventDefault();return true}}true===b.data(a.target,this.widgetName+".preventClickEvent")&&b.removeData(a.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(d){return c._mouseMove(d)};this._mouseUpDelegate=function(d){return c._mouseUp(d)};b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);a.preventDefault();return a.originalEvent.mouseHandled=
true}},_mouseMove:function(a){if(b.browser.msie&&!(document.documentMode>=9)&&!a.button)return this._mouseUp(a);if(this._mouseStarted){this._mouseDrag(a);return a.preventDefault()}if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a))(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==false)?this._mouseDrag(a):this._mouseUp(a);return!this._mouseStarted},_mouseUp:function(a){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);
if(this._mouseStarted){this._mouseStarted=false;a.target==this._mouseDownEvent.target&&b.data(a.target,this.widgetName+".preventClickEvent",true);this._mouseStop(a)}return false},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
;/*
 * jQuery UI Position 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 */
(function(c){c.ui=c.ui||{};var n=/left|center|right/,o=/top|center|bottom/,t=c.fn.position,u=c.fn.offset;c.fn.position=function(b){if(!b||!b.of)return t.apply(this,arguments);b=c.extend({},b);var a=c(b.of),d=a[0],g=(b.collision||"flip").split(" "),e=b.offset?b.offset.split(" "):[0,0],h,k,j;if(d.nodeType===9){h=a.width();k=a.height();j={top:0,left:0}}else if(d.setTimeout){h=a.width();k=a.height();j={top:a.scrollTop(),left:a.scrollLeft()}}else if(d.preventDefault){b.at="left top";h=k=0;j={top:b.of.pageY,
left:b.of.pageX}}else{h=a.outerWidth();k=a.outerHeight();j=a.offset()}c.each(["my","at"],function(){var f=(b[this]||"").split(" ");if(f.length===1)f=n.test(f[0])?f.concat(["center"]):o.test(f[0])?["center"].concat(f):["center","center"];f[0]=n.test(f[0])?f[0]:"center";f[1]=o.test(f[1])?f[1]:"center";b[this]=f});if(g.length===1)g[1]=g[0];e[0]=parseInt(e[0],10)||0;if(e.length===1)e[1]=e[0];e[1]=parseInt(e[1],10)||0;if(b.at[0]==="right")j.left+=h;else if(b.at[0]==="center")j.left+=h/2;if(b.at[1]==="bottom")j.top+=
k;else if(b.at[1]==="center")j.top+=k/2;j.left+=e[0];j.top+=e[1];return this.each(function(){var f=c(this),l=f.outerWidth(),m=f.outerHeight(),p=parseInt(c.curCSS(this,"marginLeft",true))||0,q=parseInt(c.curCSS(this,"marginTop",true))||0,v=l+p+(parseInt(c.curCSS(this,"marginRight",true))||0),w=m+q+(parseInt(c.curCSS(this,"marginBottom",true))||0),i=c.extend({},j),r;if(b.my[0]==="right")i.left-=l;else if(b.my[0]==="center")i.left-=l/2;if(b.my[1]==="bottom")i.top-=m;else if(b.my[1]==="center")i.top-=
m/2;i.left=Math.round(i.left);i.top=Math.round(i.top);r={left:i.left-p,top:i.top-q};c.each(["left","top"],function(s,x){c.ui.position[g[s]]&&c.ui.position[g[s]][x](i,{targetWidth:h,targetHeight:k,elemWidth:l,elemHeight:m,collisionPosition:r,collisionWidth:v,collisionHeight:w,offset:e,my:b.my,at:b.at})});c.fn.bgiframe&&f.bgiframe();f.offset(c.extend(i,{using:b.using}))})};c.ui.position={fit:{left:function(b,a){var d=c(window);d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();b.left=
d>0?b.left-d:Math.max(b.left-a.collisionPosition.left,b.left)},top:function(b,a){var d=c(window);d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();b.top=d>0?b.top-d:Math.max(b.top-a.collisionPosition.top,b.top)}},flip:{left:function(b,a){if(a.at[0]!=="center"){var d=c(window);d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();var g=a.my[0]==="left"?-a.elemWidth:a.my[0]==="right"?a.elemWidth:0,e=a.at[0]==="left"?a.targetWidth:-a.targetWidth,h=-2*a.offset[0];b.left+=
a.collisionPosition.left<0?g+e+h:d>0?g+e+h:0}},top:function(b,a){if(a.at[1]!=="center"){var d=c(window);d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();var g=a.my[1]==="top"?-a.elemHeight:a.my[1]==="bottom"?a.elemHeight:0,e=a.at[1]==="top"?a.targetHeight:-a.targetHeight,h=-2*a.offset[1];b.top+=a.collisionPosition.top<0?g+e+h:d>0?g+e+h:0}}}};if(!c.offset.setOffset){c.offset.setOffset=function(b,a){if(/static/.test(c.curCSS(b,"position")))b.style.position="relative";var d=c(b),
g=d.offset(),e=parseInt(c.curCSS(b,"top",true),10)||0,h=parseInt(c.curCSS(b,"left",true),10)||0;g={top:a.top-g.top+e,left:a.left-g.left+h};"using"in a?a.using.call(b,g):d.css(g)};c.fn.offset=function(b){var a=this[0];if(!a||!a.ownerDocument)return null;if(b)return this.each(function(){c.offset.setOffset(this,b)});return u.call(this)}}})(jQuery);
;/*
 * jQuery UI Draggable 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Draggables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(d){d.widget("ui.draggable",d.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper==
"original"&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position="relative";this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(a){var b=
this.options;if(this.helper||b.disabled||d(a.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(a);if(!this.handle)return false;return true},_mouseStart:function(a){var b=this.options;this.helper=this._createHelper(a);this._cacheHelperProportions();if(d.ui.ddmanager)d.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-
this.margins.top,left:this.offset.left-this.margins.left};d.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt);b.containment&&this._setContainment();if(this._trigger("start",a)===false){this._clear();return false}this._cacheHelperProportions();
d.ui.ddmanager&&!b.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,a);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(a,true);return true},_mouseDrag:function(a,b){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!b){b=this._uiHash();if(this._trigger("drag",a,b)===false){this._mouseUp({});return false}this.position=b.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||
this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";d.ui.ddmanager&&d.ui.ddmanager.drag(this,a);return false},_mouseStop:function(a){var b=false;if(d.ui.ddmanager&&!this.options.dropBehaviour)b=d.ui.ddmanager.drop(this,a);if(this.dropped){b=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!b||this.options.revert=="valid"&&b||this.options.revert===true||d.isFunction(this.options.revert)&&
this.options.revert.call(this.element,b)){var c=this;d(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",a)!==false&&c._clear()})}else this._trigger("stop",a)!==false&&this._clear();return false},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(a){var b=!this.options.handle||!d(this.options.handle,this.element).length?true:false;d(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==
a.target)b=true});return b},_createHelper:function(a){var b=this.options;a=d.isFunction(b.helper)?d(b.helper.apply(this.element[0],[a])):b.helper=="clone"?this.element.clone():this.element;a.parents("body").length||a.appendTo(b.appendTo=="parent"?this.element[0].parentNode:b.appendTo);a[0]!=this.element[0]&&!/(fixed|absolute)/.test(a.css("position"))&&a.css("position","absolute");return a},_adjustOffsetFromHelper:function(a){if(typeof a=="string")a=a.split(" ");if(d.isArray(a))a={left:+a[0],top:+a[1]||
0};if("left"in a)this.offset.click.left=a.left+this.margins.left;if("right"in a)this.offset.click.left=this.helperProportions.width-a.right+this.margins.left;if("top"in a)this.offset.click.top=a.top+this.margins.top;if("bottom"in a)this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],
this.offsetParent[0])){a.left+=this.scrollParent.scrollLeft();a.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&d.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),
height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;if(a.containment=="parent")a.containment=this.helper[0].parentNode;if(a.containment=="document"||a.containment=="window")this.containment=[(a.containment=="document"?0:d(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(a.containment=="document"?0:d(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(a.containment=="document"?0:d(window).scrollLeft())+d(a.containment=="document"?
document:window).width()-this.helperProportions.width-this.margins.left,(a.containment=="document"?0:d(window).scrollTop())+(d(a.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)&&a.containment.constructor!=Array){var b=d(a.containment)[0];if(b){a=d(a.containment).offset();var c=d(b).css("overflow")!="hidden";this.containment=[a.left+(parseInt(d(b).css("borderLeftWidth"),
10)||0)+(parseInt(d(b).css("paddingLeft"),10)||0),a.top+(parseInt(d(b).css("borderTopWidth"),10)||0)+(parseInt(d(b).css("paddingTop"),10)||0),a.left+(c?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(d(b).css("borderLeftWidth"),10)||0)-(parseInt(d(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,a.top+(c?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(d(b).css("borderTopWidth"),10)||0)-(parseInt(d(b).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom]}}else if(a.containment.constructor==Array)this.containment=a.containment},_convertPositionTo:function(a,b){if(!b)b=this.position;a=a=="absolute"?1:-1;var c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(c[0].tagName);return{top:b.top+this.offset.relative.top*a+this.offset.parent.top*a-(d.browser.safari&&
d.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:c.scrollTop())*a),left:b.left+this.offset.relative.left*a+this.offset.parent.left*a-(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:c.scrollLeft())*a)}},_generatePosition:function(a){var b=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],
this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(c[0].tagName),e=a.pageX,g=a.pageY;if(this.originalPosition){if(this.containment){if(a.pageX-this.offset.click.left<this.containment[0])e=this.containment[0]+this.offset.click.left;if(a.pageY-this.offset.click.top<this.containment[1])g=this.containment[1]+this.offset.click.top;if(a.pageX-this.offset.click.left>this.containment[2])e=this.containment[2]+this.offset.click.left;if(a.pageY-this.offset.click.top>this.containment[3])g=
this.containment[3]+this.offset.click.top}if(b.grid){g=this.originalPageY+Math.round((g-this.originalPageY)/b.grid[1])*b.grid[1];g=this.containment?!(g-this.offset.click.top<this.containment[1]||g-this.offset.click.top>this.containment[3])?g:!(g-this.offset.click.top<this.containment[1])?g-b.grid[1]:g+b.grid[1]:g;e=this.originalPageX+Math.round((e-this.originalPageX)/b.grid[0])*b.grid[0];e=this.containment?!(e-this.offset.click.left<this.containment[0]||e-this.offset.click.left>this.containment[2])?
e:!(e-this.offset.click.left<this.containment[0])?e-b.grid[0]:e+b.grid[0]:e}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:c.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():
f?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(a,b,c){c=c||this._uiHash();d.ui.plugin.call(this,a,[b,c]);if(a=="drag")this.positionAbs=this._convertPositionTo("absolute");return d.Widget.prototype._trigger.call(this,a,b,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,
offset:this.positionAbs}}});d.extend(d.ui.draggable,{version:"1.8.11"});d.ui.plugin.add("draggable","connectToSortable",{start:function(a,b){var c=d(this).data("draggable"),f=c.options,e=d.extend({},b,{item:c.element});c.sortables=[];d(f.connectToSortable).each(function(){var g=d.data(this,"sortable");if(g&&!g.options.disabled){c.sortables.push({instance:g,shouldRevert:g.options.revert});g.refreshPositions();g._trigger("activate",a,e)}})},stop:function(a,b){var c=d(this).data("draggable"),f=d.extend({},
b,{item:c.element});d.each(c.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;c.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert)this.instance.options.revert=true;this.instance._mouseStop(a);this.instance.options.helper=this.instance.options._helper;c.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",a,f)}})},drag:function(a,b){var c=
d(this).data("draggable"),f=this;d.each(c.sortables,function(){this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=d(f).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return b.helper[0]};
a.target=this.instance.currentItem[0];this.instance._mouseCapture(a,true);this.instance._mouseStart(a,true,true);this.instance.offset.click.top=c.offset.click.top;this.instance.offset.click.left=c.offset.click.left;this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top;c._trigger("toSortable",a);c.dropped=this.instance.element;c.currentItem=c.element;this.instance.fromOutside=c}this.instance.currentItem&&
this.instance._mouseDrag(a)}else if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",a,this.instance._uiHash(this.instance));this.instance._mouseStop(a,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&this.instance.placeholder.remove();c._trigger("fromSortable",a);c.dropped=false}})}});d.ui.plugin.add("draggable","cursor",
{start:function(){var a=d("body"),b=d(this).data("draggable").options;if(a.css("cursor"))b._cursor=a.css("cursor");a.css("cursor",b.cursor)},stop:function(){var a=d(this).data("draggable").options;a._cursor&&d("body").css("cursor",a._cursor)}});d.ui.plugin.add("draggable","iframeFix",{start:function(){var a=d(this).data("draggable").options;d(a.iframeFix===true?"iframe":a.iframeFix).each(function(){d('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+
"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(d(this).offset()).appendTo("body")})},stop:function(){d("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});d.ui.plugin.add("draggable","opacity",{start:function(a,b){a=d(b.helper);b=d(this).data("draggable").options;if(a.css("opacity"))b._opacity=a.css("opacity");a.css("opacity",b.opacity)},stop:function(a,b){a=d(this).data("draggable").options;a._opacity&&d(b.helper).css("opacity",
a._opacity)}});d.ui.plugin.add("draggable","scroll",{start:function(){var a=d(this).data("draggable");if(a.scrollParent[0]!=document&&a.scrollParent[0].tagName!="HTML")a.overflowOffset=a.scrollParent.offset()},drag:function(a){var b=d(this).data("draggable"),c=b.options,f=false;if(b.scrollParent[0]!=document&&b.scrollParent[0].tagName!="HTML"){if(!c.axis||c.axis!="x")if(b.overflowOffset.top+b.scrollParent[0].offsetHeight-a.pageY<c.scrollSensitivity)b.scrollParent[0].scrollTop=f=b.scrollParent[0].scrollTop+
c.scrollSpeed;else if(a.pageY-b.overflowOffset.top<c.scrollSensitivity)b.scrollParent[0].scrollTop=f=b.scrollParent[0].scrollTop-c.scrollSpeed;if(!c.axis||c.axis!="y")if(b.overflowOffset.left+b.scrollParent[0].offsetWidth-a.pageX<c.scrollSensitivity)b.scrollParent[0].scrollLeft=f=b.scrollParent[0].scrollLeft+c.scrollSpeed;else if(a.pageX-b.overflowOffset.left<c.scrollSensitivity)b.scrollParent[0].scrollLeft=f=b.scrollParent[0].scrollLeft-c.scrollSpeed}else{if(!c.axis||c.axis!="x")if(a.pageY-d(document).scrollTop()<
c.scrollSensitivity)f=d(document).scrollTop(d(document).scrollTop()-c.scrollSpeed);else if(d(window).height()-(a.pageY-d(document).scrollTop())<c.scrollSensitivity)f=d(document).scrollTop(d(document).scrollTop()+c.scrollSpeed);if(!c.axis||c.axis!="y")if(a.pageX-d(document).scrollLeft()<c.scrollSensitivity)f=d(document).scrollLeft(d(document).scrollLeft()-c.scrollSpeed);else if(d(window).width()-(a.pageX-d(document).scrollLeft())<c.scrollSensitivity)f=d(document).scrollLeft(d(document).scrollLeft()+
c.scrollSpeed)}f!==false&&d.ui.ddmanager&&!c.dropBehaviour&&d.ui.ddmanager.prepareOffsets(b,a)}});d.ui.plugin.add("draggable","snap",{start:function(){var a=d(this).data("draggable"),b=a.options;a.snapElements=[];d(b.snap.constructor!=String?b.snap.items||":data(draggable)":b.snap).each(function(){var c=d(this),f=c.offset();this!=a.element[0]&&a.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:f.top,left:f.left})})},drag:function(a,b){for(var c=d(this).data("draggable"),
f=c.options,e=f.snapTolerance,g=b.offset.left,n=g+c.helperProportions.width,m=b.offset.top,o=m+c.helperProportions.height,h=c.snapElements.length-1;h>=0;h--){var i=c.snapElements[h].left,k=i+c.snapElements[h].width,j=c.snapElements[h].top,l=j+c.snapElements[h].height;if(i-e<g&&g<k+e&&j-e<m&&m<l+e||i-e<g&&g<k+e&&j-e<o&&o<l+e||i-e<n&&n<k+e&&j-e<m&&m<l+e||i-e<n&&n<k+e&&j-e<o&&o<l+e){if(f.snapMode!="inner"){var p=Math.abs(j-o)<=e,q=Math.abs(l-m)<=e,r=Math.abs(i-n)<=e,s=Math.abs(k-g)<=e;if(p)b.position.top=
c._convertPositionTo("relative",{top:j-c.helperProportions.height,left:0}).top-c.margins.top;if(q)b.position.top=c._convertPositionTo("relative",{top:l,left:0}).top-c.margins.top;if(r)b.position.left=c._convertPositionTo("relative",{top:0,left:i-c.helperProportions.width}).left-c.margins.left;if(s)b.position.left=c._convertPositionTo("relative",{top:0,left:k}).left-c.margins.left}var t=p||q||r||s;if(f.snapMode!="outer"){p=Math.abs(j-m)<=e;q=Math.abs(l-o)<=e;r=Math.abs(i-g)<=e;s=Math.abs(k-n)<=e;if(p)b.position.top=
c._convertPositionTo("relative",{top:j,left:0}).top-c.margins.top;if(q)b.position.top=c._convertPositionTo("relative",{top:l-c.helperProportions.height,left:0}).top-c.margins.top;if(r)b.position.left=c._convertPositionTo("relative",{top:0,left:i}).left-c.margins.left;if(s)b.position.left=c._convertPositionTo("relative",{top:0,left:k-c.helperProportions.width}).left-c.margins.left}if(!c.snapElements[h].snapping&&(p||q||r||s||t))c.options.snap.snap&&c.options.snap.snap.call(c.element,a,d.extend(c._uiHash(),
{snapItem:c.snapElements[h].item}));c.snapElements[h].snapping=p||q||r||s||t}else{c.snapElements[h].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,a,d.extend(c._uiHash(),{snapItem:c.snapElements[h].item}));c.snapElements[h].snapping=false}}}});d.ui.plugin.add("draggable","stack",{start:function(){var a=d(this).data("draggable").options;a=d.makeArray(d(a.stack)).sort(function(c,f){return(parseInt(d(c).css("zIndex"),10)||0)-(parseInt(d(f).css("zIndex"),10)||0)});if(a.length){var b=
parseInt(a[0].style.zIndex)||0;d(a).each(function(c){this.style.zIndex=b+c});this[0].style.zIndex=b+a.length}}});d.ui.plugin.add("draggable","zIndex",{start:function(a,b){a=d(b.helper);b=d(this).data("draggable").options;if(a.css("zIndex"))b._zIndex=a.css("zIndex");a.css("zIndex",b.zIndex)},stop:function(a,b){a=d(this).data("draggable").options;a._zIndex&&d(b.helper).css("zIndex",a._zIndex)}})})(jQuery);
;/*
 * jQuery UI Resizable 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Resizables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(e){e.widget("ui.resizable",e.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var b=this,a=this.options;this.element.addClass("ui-resizable");e.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,
_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){/relative/.test(this.element.css("position"))&&e.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"});this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),
top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=
this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=a.handles||(!e(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",
nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all")this.handles="n,e,s,w,se,sw,ne,nw";var c=this.handles.split(",");this.handles={};for(var d=0;d<c.length;d++){var f=e.trim(c[d]),g=e('<div class="ui-resizable-handle '+("ui-resizable-"+f)+'"></div>');/sw|se|ne|nw/.test(f)&&g.css({zIndex:++a.zIndex});"se"==f&&g.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[f]=".ui-resizable-"+f;this.element.append(g)}}this._renderAxis=function(h){h=h||this.element;for(var i in this.handles){if(this.handles[i].constructor==
String)this.handles[i]=e(this.handles[i],this.element).show();if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var j=e(this.handles[i],this.element),k=0;k=/sw|ne|nw|se|n|s/.test(i)?j.outerHeight():j.outerWidth();j=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");h.css(j,k);this._proportionallyResize()}e(this.handles[i])}};this._renderAxis(this.element);this._handles=e(".ui-resizable-handle",this.element).disableSelection();
this._handles.mouseover(function(){if(!b.resizing){if(this.className)var h=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=h&&h[1]?h[1]:"se"}});if(a.autoHide){this._handles.hide();e(this.element).addClass("ui-resizable-autohide").hover(function(){e(this).removeClass("ui-resizable-autohide");b._handles.show()},function(){if(!b.resizing){e(this).addClass("ui-resizable-autohide");b._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var b=function(c){e(c).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};
if(this.elementIsWrapper){b(this.element);var a=this.element;a.after(this.originalElement.css({position:a.css("position"),width:a.outerWidth(),height:a.outerHeight(),top:a.css("top"),left:a.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);b(this.originalElement);return this},_mouseCapture:function(b){var a=false;for(var c in this.handles)if(e(this.handles[c])[0]==b.target)a=true;return!this.options.disabled&&a},_mouseStart:function(b){var a=this.options,c=this.element.position(),
d=this.element;this.resizing=true;this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()};if(d.is(".ui-draggable")||/absolute/.test(d.css("position")))d.css({position:"absolute",top:c.top,left:c.left});e.browser.opera&&/relative/.test(d.css("position"))&&d.css({position:"relative",top:"auto",left:"auto"});this._renderProxy();c=m(this.helper.css("left"));var f=m(this.helper.css("top"));if(a.containment){c+=e(a.containment).scrollLeft()||0;f+=e(a.containment).scrollTop()||0}this.offset=
this.helper.offset();this.position={left:c,top:f};this.size=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()};this.originalSize=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()};this.originalPosition={left:c,top:f};this.sizeDiff={width:d.outerWidth()-d.width(),height:d.outerHeight()-d.height()};this.originalMousePosition={left:b.pageX,top:b.pageY};this.aspectRatio=typeof a.aspectRatio=="number"?a.aspectRatio:
this.originalSize.width/this.originalSize.height||1;a=e(".ui-resizable-"+this.axis).css("cursor");e("body").css("cursor",a=="auto"?this.axis+"-resize":a);d.addClass("ui-resizable-resizing");this._propagate("start",b);return true},_mouseDrag:function(b){var a=this.helper,c=this.originalMousePosition,d=this._change[this.axis];if(!d)return false;c=d.apply(this,[b,b.pageX-c.left||0,b.pageY-c.top||0]);if(this._aspectRatio||b.shiftKey)c=this._updateRatio(c,b);c=this._respectSize(c,b);this._propagate("resize",
b);a.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(c);this._trigger("resize",b,this.ui());return false},_mouseStop:function(b){this.resizing=false;var a=this.options,c=this;if(this._helper){var d=this._proportionallyResizeElements,f=d.length&&/textarea/i.test(d[0].nodeName);d=f&&e.ui.hasScroll(d[0],"left")?0:c.sizeDiff.height;
f=f?0:c.sizeDiff.width;f={width:c.helper.width()-f,height:c.helper.height()-d};d=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null;var g=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;a.animate||this.element.css(e.extend(f,{top:g,left:d}));c.helper.height(c.size.height);c.helper.width(c.size.width);this._helper&&!a.animate&&this._proportionallyResize()}e("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");
this._propagate("stop",b);this._helper&&this.helper.remove();return false},_updateCache:function(b){this.offset=this.helper.offset();if(l(b.left))this.position.left=b.left;if(l(b.top))this.position.top=b.top;if(l(b.height))this.size.height=b.height;if(l(b.width))this.size.width=b.width},_updateRatio:function(b){var a=this.position,c=this.size,d=this.axis;if(b.height)b.width=c.height*this.aspectRatio;else if(b.width)b.height=c.width/this.aspectRatio;if(d=="sw"){b.left=a.left+(c.width-b.width);b.top=
null}if(d=="nw"){b.top=a.top+(c.height-b.height);b.left=a.left+(c.width-b.width)}return b},_respectSize:function(b){var a=this.options,c=this.axis,d=l(b.width)&&a.maxWidth&&a.maxWidth<b.width,f=l(b.height)&&a.maxHeight&&a.maxHeight<b.height,g=l(b.width)&&a.minWidth&&a.minWidth>b.width,h=l(b.height)&&a.minHeight&&a.minHeight>b.height;if(g)b.width=a.minWidth;if(h)b.height=a.minHeight;if(d)b.width=a.maxWidth;if(f)b.height=a.maxHeight;var i=this.originalPosition.left+this.originalSize.width,j=this.position.top+
this.size.height,k=/sw|nw|w/.test(c);c=/nw|ne|n/.test(c);if(g&&k)b.left=i-a.minWidth;if(d&&k)b.left=i-a.maxWidth;if(h&&c)b.top=j-a.minHeight;if(f&&c)b.top=j-a.maxHeight;if((a=!b.width&&!b.height)&&!b.left&&b.top)b.top=null;else if(a&&!b.top&&b.left)b.left=null;return b},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b=this.helper||this.element,a=0;a<this._proportionallyResizeElements.length;a++){var c=this._proportionallyResizeElements[a];if(!this.borderDif){var d=
[c.css("borderTopWidth"),c.css("borderRightWidth"),c.css("borderBottomWidth"),c.css("borderLeftWidth")],f=[c.css("paddingTop"),c.css("paddingRight"),c.css("paddingBottom"),c.css("paddingLeft")];this.borderDif=e.map(d,function(g,h){g=parseInt(g,10)||0;h=parseInt(f[h],10)||0;return g+h})}e.browser.msie&&(e(b).is(":hidden")||e(b).parents(":hidden").length)||c.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=
this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var a=e.browser.msie&&e.browser.version<7,c=a?1:0;a=a?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+a,height:this.element.outerHeight()+a,position:"absolute",left:this.elementOffset.left-c+"px",top:this.elementOffset.top-c+"px",zIndex:++b.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(b,
a){return{width:this.originalSize.width+a}},w:function(b,a){return{left:this.originalPosition.left+a,width:this.originalSize.width-a}},n:function(b,a,c){return{top:this.originalPosition.top+c,height:this.originalSize.height-c}},s:function(b,a,c){return{height:this.originalSize.height+c}},se:function(b,a,c){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,a,c]))},sw:function(b,a,c){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,a,
c]))},ne:function(b,a,c){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,a,c]))},nw:function(b,a,c){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,a,c]))}},_propagate:function(b,a){e.ui.plugin.call(this,b,[a,this.ui()]);b!="resize"&&this._trigger(b,a,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,
originalPosition:this.originalPosition}}});e.extend(e.ui.resizable,{version:"1.8.11"});e.ui.plugin.add("resizable","alsoResize",{start:function(){var b=e(this).data("resizable").options,a=function(c){e(c).each(function(){var d=e(this);d.data("resizable-alsoresize",{width:parseInt(d.width(),10),height:parseInt(d.height(),10),left:parseInt(d.css("left"),10),top:parseInt(d.css("top"),10),position:d.css("position")})})};if(typeof b.alsoResize=="object"&&!b.alsoResize.parentNode)if(b.alsoResize.length){b.alsoResize=
b.alsoResize[0];a(b.alsoResize)}else e.each(b.alsoResize,function(c){a(c)});else a(b.alsoResize)},resize:function(b,a){var c=e(this).data("resizable");b=c.options;var d=c.originalSize,f=c.originalPosition,g={height:c.size.height-d.height||0,width:c.size.width-d.width||0,top:c.position.top-f.top||0,left:c.position.left-f.left||0},h=function(i,j){e(i).each(function(){var k=e(this),q=e(this).data("resizable-alsoresize"),p={},r=j&&j.length?j:k.parents(a.originalElement[0]).length?["width","height"]:["width",
"height","top","left"];e.each(r,function(n,o){if((n=(q[o]||0)+(g[o]||0))&&n>=0)p[o]=n||null});if(e.browser.opera&&/relative/.test(k.css("position"))){c._revertToRelativePosition=true;k.css({position:"absolute",top:"auto",left:"auto"})}k.css(p)})};typeof b.alsoResize=="object"&&!b.alsoResize.nodeType?e.each(b.alsoResize,function(i,j){h(i,j)}):h(b.alsoResize)},stop:function(){var b=e(this).data("resizable"),a=b.options,c=function(d){e(d).each(function(){var f=e(this);f.css({position:f.data("resizable-alsoresize").position})})};
if(b._revertToRelativePosition){b._revertToRelativePosition=false;typeof a.alsoResize=="object"&&!a.alsoResize.nodeType?e.each(a.alsoResize,function(d){c(d)}):c(a.alsoResize)}e(this).removeData("resizable-alsoresize")}});e.ui.plugin.add("resizable","animate",{stop:function(b){var a=e(this).data("resizable"),c=a.options,d=a._proportionallyResizeElements,f=d.length&&/textarea/i.test(d[0].nodeName),g=f&&e.ui.hasScroll(d[0],"left")?0:a.sizeDiff.height;f={width:a.size.width-(f?0:a.sizeDiff.width),height:a.size.height-
g};g=parseInt(a.element.css("left"),10)+(a.position.left-a.originalPosition.left)||null;var h=parseInt(a.element.css("top"),10)+(a.position.top-a.originalPosition.top)||null;a.element.animate(e.extend(f,h&&g?{top:h,left:g}:{}),{duration:c.animateDuration,easing:c.animateEasing,step:function(){var i={width:parseInt(a.element.css("width"),10),height:parseInt(a.element.css("height"),10),top:parseInt(a.element.css("top"),10),left:parseInt(a.element.css("left"),10)};d&&d.length&&e(d[0]).css({width:i.width,
height:i.height});a._updateCache(i);a._propagate("resize",b)}})}});e.ui.plugin.add("resizable","containment",{start:function(){var b=e(this).data("resizable"),a=b.element,c=b.options.containment;if(a=c instanceof e?c.get(0):/parent/.test(c)?a.parent().get(0):c){b.containerElement=e(a);if(/document/.test(c)||c==document){b.containerOffset={left:0,top:0};b.containerPosition={left:0,top:0};b.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}}else{var d=
e(a),f=[];e(["Top","Right","Left","Bottom"]).each(function(i,j){f[i]=m(d.css("padding"+j))});b.containerOffset=d.offset();b.containerPosition=d.position();b.containerSize={height:d.innerHeight()-f[3],width:d.innerWidth()-f[1]};c=b.containerOffset;var g=b.containerSize.height,h=b.containerSize.width;h=e.ui.hasScroll(a,"left")?a.scrollWidth:h;g=e.ui.hasScroll(a)?a.scrollHeight:g;b.parentData={element:a,left:c.left,top:c.top,width:h,height:g}}}},resize:function(b){var a=e(this).data("resizable"),c=a.options,
d=a.containerOffset,f=a.position;b=a._aspectRatio||b.shiftKey;var g={top:0,left:0},h=a.containerElement;if(h[0]!=document&&/static/.test(h.css("position")))g=d;if(f.left<(a._helper?d.left:0)){a.size.width+=a._helper?a.position.left-d.left:a.position.left-g.left;if(b)a.size.height=a.size.width/c.aspectRatio;a.position.left=c.helper?d.left:0}if(f.top<(a._helper?d.top:0)){a.size.height+=a._helper?a.position.top-d.top:a.position.top;if(b)a.size.width=a.size.height*c.aspectRatio;a.position.top=a._helper?
d.top:0}a.offset.left=a.parentData.left+a.position.left;a.offset.top=a.parentData.top+a.position.top;c=Math.abs((a._helper?a.offset.left-g.left:a.offset.left-g.left)+a.sizeDiff.width);d=Math.abs((a._helper?a.offset.top-g.top:a.offset.top-d.top)+a.sizeDiff.height);f=a.containerElement.get(0)==a.element.parent().get(0);g=/relative|absolute/.test(a.containerElement.css("position"));if(f&&g)c-=a.parentData.left;if(c+a.size.width>=a.parentData.width){a.size.width=a.parentData.width-c;if(b)a.size.height=
a.size.width/a.aspectRatio}if(d+a.size.height>=a.parentData.height){a.size.height=a.parentData.height-d;if(b)a.size.width=a.size.height*a.aspectRatio}},stop:function(){var b=e(this).data("resizable"),a=b.options,c=b.containerOffset,d=b.containerPosition,f=b.containerElement,g=e(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width;g=g.outerHeight()-b.sizeDiff.height;b._helper&&!a.animate&&/relative/.test(f.css("position"))&&e(this).css({left:h.left-d.left-c.left,width:i,height:g});b._helper&&!a.animate&&
/static/.test(f.css("position"))&&e(this).css({left:h.left-d.left-c.left,width:i,height:g})}});e.ui.plugin.add("resizable","ghost",{start:function(){var b=e(this).data("resizable"),a=b.options,c=b.size;b.ghost=b.originalElement.clone();b.ghost.css({opacity:0.25,display:"block",position:"relative",height:c.height,width:c.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof a.ghost=="string"?a.ghost:"");b.ghost.appendTo(b.helper)},resize:function(){var b=e(this).data("resizable");
b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=e(this).data("resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}});e.ui.plugin.add("resizable","grid",{resize:function(){var b=e(this).data("resizable"),a=b.options,c=b.size,d=b.originalSize,f=b.originalPosition,g=b.axis;a.grid=typeof a.grid=="number"?[a.grid,a.grid]:a.grid;var h=Math.round((c.width-d.width)/(a.grid[0]||1))*(a.grid[0]||1);a=Math.round((c.height-d.height)/
(a.grid[1]||1))*(a.grid[1]||1);if(/^(se|s|e)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a}else if(/^(ne)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a;b.position.top=f.top-a}else{if(/^(sw)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a}else{b.size.width=d.width+h;b.size.height=d.height+a;b.position.top=f.top-a}b.position.left=f.left-h}}});var m=function(b){return parseInt(b,10)||0},l=function(b){return!isNaN(parseInt(b,10))}})(jQuery);
;/*
 * jQuery UI Button 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Button
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(a){var g,i=function(b){a(":ui-button",b.target.form).each(function(){var c=a(this).data("button");setTimeout(function(){c.refresh()},1)})},h=function(b){var c=b.name,d=b.form,f=a([]);if(c)f=d?a(d).find("[name='"+c+"']"):a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form});return f};a.widget("ui.button",{options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",
i);if(typeof this.options.disabled!=="boolean")this.options.disabled=this.element.attr("disabled");this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var b=this,c=this.options,d=this.type==="checkbox"||this.type==="radio",f="ui-state-hover"+(!d?" ui-state-active":"");if(c.label===null)c.label=this.buttonElement.html();if(this.element.is(":disabled"))c.disabled=true;this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",
function(){if(!c.disabled){a(this).addClass("ui-state-hover");this===g&&a(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){c.disabled||a(this).removeClass(f)}).bind("focus.button",function(){a(this).addClass("ui-state-focus")}).bind("blur.button",function(){a(this).removeClass("ui-state-focus")});d&&this.element.bind("change.button",function(){b.refresh()});if(this.type==="checkbox")this.buttonElement.bind("click.button",function(){if(c.disabled)return false;a(this).toggleClass("ui-state-active");
b.buttonElement.attr("aria-pressed",b.element[0].checked)});else if(this.type==="radio")this.buttonElement.bind("click.button",function(){if(c.disabled)return false;a(this).addClass("ui-state-active");b.buttonElement.attr("aria-pressed",true);var e=b.element[0];h(e).not(e).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",false)});else{this.buttonElement.bind("mousedown.button",function(){if(c.disabled)return false;a(this).addClass("ui-state-active");
g=this;a(document).one("mouseup",function(){g=null})}).bind("mouseup.button",function(){if(c.disabled)return false;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(e){if(c.disabled)return false;if(e.keyCode==a.ui.keyCode.SPACE||e.keyCode==a.ui.keyCode.ENTER)a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")});this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===a.ui.keyCode.SPACE&&a(this).click()})}this._setOption("disabled",
c.disabled)},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?"input":"button";if(this.type==="checkbox"||this.type==="radio"){var b=this.element.parents().filter(":last"),c="label[for="+this.element.attr("id")+"]";this.buttonElement=b.find(c);if(!this.buttonElement.length){b=b.length?b.siblings():this.element.siblings();this.buttonElement=b.filter(c);if(!this.buttonElement.length)this.buttonElement=b.find(c)}this.element.addClass("ui-helper-hidden-accessible");
(b=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active");this.buttonElement.attr("aria-pressed",b)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title");a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments);if(b==="disabled")c?this.element.attr("disabled",true):this.element.removeAttr("disabled");this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b);if(this.type==="radio")h(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed",
true):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",false)});else if(this.type==="checkbox")this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed",true):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",false)},_resetButton:function(){if(this.type==="input")this.options.label&&this.element.val(this.options.label);else{var b=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
c=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,f=d.primary&&d.secondary,e=[];if(d.primary||d.secondary){if(this.options.text)e.push("ui-button-text-icon"+(f?"s":d.primary?"-primary":"-secondary"));d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>");d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>");if(!this.options.text){e.push(f?"ui-button-icons-only":
"ui-button-icon-only");this.hasTitle||b.attr("title",c)}}else e.push("ui-button-text-only");b.addClass(e.join(" "))}}});a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(b,c){b==="disabled"&&this.buttons.button("option",b,c);a.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass("ui-corner-left").end().filter(":last").addClass("ui-corner-right").end().end()},
destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");a.Widget.prototype.destroy.call(this)}})})(jQuery);
;/*
 * jQuery UI Dialog 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Dialog
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *  jquery.ui.button.js
 *	jquery.ui.draggable.js
 *	jquery.ui.mouse.js
 *	jquery.ui.position.js
 *	jquery.ui.resizable.js
 */
(function(c,j){var k={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},l={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};c.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",collision:"fit",using:function(a){var b=c(this).css(a).offset().top;b<0&&
c(this).css("top",a.top-b)}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string")this.originalTitle="";this.options.title=this.options.title||this.originalTitle;var a=this,b=a.options,d=b.title||"&#160;",e=c.ui.dialog.getTitleId(a.element),g=(a.uiDialog=c("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b.dialogClass).css({zIndex:b.zIndex}).attr("tabIndex",
-1).css("outline",0).keydown(function(i){if(b.closeOnEscape&&i.keyCode&&i.keyCode===c.ui.keyCode.ESCAPE){a.close(i);i.preventDefault()}}).attr({role:"dialog","aria-labelledby":e}).mousedown(function(i){a.moveToTop(false,i)});a.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(g);var f=(a.uiDialogTitlebar=c("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(g),h=c('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role",
"button").hover(function(){h.addClass("ui-state-hover")},function(){h.removeClass("ui-state-hover")}).focus(function(){h.addClass("ui-state-focus")}).blur(function(){h.removeClass("ui-state-focus")}).click(function(i){a.close(i);return false}).appendTo(f);(a.uiDialogTitlebarCloseText=c("<span></span>")).addClass("ui-icon ui-icon-closethick").text(b.closeText).appendTo(h);c("<span></span>").addClass("ui-dialog-title").attr("id",e).html(d).prependTo(f);if(c.isFunction(b.beforeclose)&&!c.isFunction(b.beforeClose))b.beforeClose=
b.beforeclose;f.find("*").add(f).disableSelection();b.draggable&&c.fn.draggable&&a._makeDraggable();b.resizable&&c.fn.resizable&&a._makeResizable();a._createButtons(b.buttons);a._isOpen=false;c.fn.bgiframe&&g.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var a=this;a.overlay&&a.overlay.destroy();a.uiDialog.hide();a.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");a.uiDialog.remove();a.originalTitle&&
a.element.attr("title",a.originalTitle);return a},widget:function(){return this.uiDialog},close:function(a){var b=this,d,e;if(false!==b._trigger("beforeClose",a)){b.overlay&&b.overlay.destroy();b.uiDialog.unbind("keypress.ui-dialog");b._isOpen=false;if(b.options.hide)b.uiDialog.hide(b.options.hide,function(){b._trigger("close",a)});else{b.uiDialog.hide();b._trigger("close",a)}c.ui.dialog.overlay.resize();if(b.options.modal){d=0;c(".ui-dialog").each(function(){if(this!==b.uiDialog[0]){e=c(this).css("z-index");
isNaN(e)||(d=Math.max(d,e))}});c.ui.dialog.maxZ=d}return b}},isOpen:function(){return this._isOpen},moveToTop:function(a,b){var d=this,e=d.options;if(e.modal&&!a||!e.stack&&!e.modal)return d._trigger("focus",b);if(e.zIndex>c.ui.dialog.maxZ)c.ui.dialog.maxZ=e.zIndex;if(d.overlay){c.ui.dialog.maxZ+=1;d.overlay.$el.css("z-index",c.ui.dialog.overlay.maxZ=c.ui.dialog.maxZ)}a={scrollTop:d.element.attr("scrollTop"),scrollLeft:d.element.attr("scrollLeft")};c.ui.dialog.maxZ+=1;d.uiDialog.css("z-index",c.ui.dialog.maxZ);
d.element.attr(a);d._trigger("focus",b);return d},open:function(){if(!this._isOpen){var a=this,b=a.options,d=a.uiDialog;a.overlay=b.modal?new c.ui.dialog.overlay(a):null;a._size();a._position(b.position);d.show(b.show);a.moveToTop(true);b.modal&&d.bind("keypress.ui-dialog",function(e){if(e.keyCode===c.ui.keyCode.TAB){var g=c(":tabbable",this),f=g.filter(":first");g=g.filter(":last");if(e.target===g[0]&&!e.shiftKey){f.focus(1);return false}else if(e.target===f[0]&&e.shiftKey){g.focus(1);return false}}});
c(a.element.find(":tabbable").get().concat(d.find(".ui-dialog-buttonpane :tabbable").get().concat(d.get()))).eq(0).focus();a._isOpen=true;a._trigger("open");return a}},_createButtons:function(a){var b=this,d=false,e=c("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),g=c("<div></div>").addClass("ui-dialog-buttonset").appendTo(e);b.uiDialog.find(".ui-dialog-buttonpane").remove();typeof a==="object"&&a!==null&&c.each(a,function(){return!(d=true)});if(d){c.each(a,function(f,
h){h=c.isFunction(h)?{click:h,text:f}:h;f=c('<button type="button"></button>').attr(h,true).unbind("click").click(function(){h.click.apply(b.element[0],arguments)}).appendTo(g);c.fn.button&&f.button()});e.appendTo(b.uiDialog)}},_makeDraggable:function(){function a(f){return{position:f.position,offset:f.offset}}var b=this,d=b.options,e=c(document),g;b.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(f,h){g=
d.height==="auto"?"auto":c(this).height();c(this).height(c(this).height()).addClass("ui-dialog-dragging");b._trigger("dragStart",f,a(h))},drag:function(f,h){b._trigger("drag",f,a(h))},stop:function(f,h){d.position=[h.position.left-e.scrollLeft(),h.position.top-e.scrollTop()];c(this).removeClass("ui-dialog-dragging").height(g);b._trigger("dragStop",f,a(h));c.ui.dialog.overlay.resize()}})},_makeResizable:function(a){function b(f){return{originalPosition:f.originalPosition,originalSize:f.originalSize,
position:f.position,size:f.size}}a=a===j?this.options.resizable:a;var d=this,e=d.options,g=d.uiDialog.css("position");a=typeof a==="string"?a:"n,e,s,w,se,sw,ne,nw";d.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:d.element,maxWidth:e.maxWidth,maxHeight:e.maxHeight,minWidth:e.minWidth,minHeight:d._minHeight(),handles:a,start:function(f,h){c(this).addClass("ui-dialog-resizing");d._trigger("resizeStart",f,b(h))},resize:function(f,h){d._trigger("resize",f,b(h))},stop:function(f,
h){c(this).removeClass("ui-dialog-resizing");e.height=c(this).height();e.width=c(this).width();d._trigger("resizeStop",f,b(h));c.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return a.height==="auto"?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(a){var b=[],d=[0,0],e;if(a){if(typeof a==="string"||typeof a==="object"&&"0"in a){b=a.split?a.split(" "):[a[0],a[1]];if(b.length===
1)b[1]=b[0];c.each(["left","top"],function(g,f){if(+b[g]===b[g]){d[g]=b[g];b[g]=f}});a={my:b.join(" "),at:b.join(" "),offset:d.join(" ")}}a=c.extend({},c.ui.dialog.prototype.options.position,a)}else a=c.ui.dialog.prototype.options.position;(e=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position(c.extend({of:window},a));e||this.uiDialog.hide()},_setOptions:function(a){var b=this,d={},e=false;c.each(a,function(g,f){b._setOption(g,f);if(g in k)e=true;if(g in
l)d[g]=f});e&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",d)},_setOption:function(a,b){var d=this,e=d.uiDialog;switch(a){case "beforeclose":a="beforeClose";break;case "buttons":d._createButtons(b);break;case "closeText":d.uiDialogTitlebarCloseText.text(""+b);break;case "dialogClass":e.removeClass(d.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b);break;case "disabled":b?e.addClass("ui-dialog-disabled"):e.removeClass("ui-dialog-disabled");
break;case "draggable":var g=e.is(":data(draggable)");g&&!b&&e.draggable("destroy");!g&&b&&d._makeDraggable();break;case "position":d._position(b);break;case "resizable":(g=e.is(":data(resizable)"))&&!b&&e.resizable("destroy");g&&typeof b==="string"&&e.resizable("option","handles",b);!g&&b!==false&&d._makeResizable(b);break;case "title":c(".ui-dialog-title",d.uiDialogTitlebar).html(""+(b||"&#160;"));break}c.Widget.prototype._setOption.apply(d,arguments)},_size:function(){var a=this.options,b,d,e=
this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(a.minWidth>a.width)a.width=a.minWidth;b=this.uiDialog.css({height:"auto",width:a.width}).height();d=Math.max(0,a.minHeight-b);if(a.height==="auto")if(c.support.minHeight)this.element.css({minHeight:d,height:"auto"});else{this.uiDialog.show();a=this.element.css("height","auto").height();e||this.uiDialog.hide();this.element.height(Math.max(a,d))}else this.element.height(Math.max(a.height-b,0));this.uiDialog.is(":data(resizable)")&&
this.uiDialog.resizable("option","minHeight",this._minHeight())}});c.extend(c.ui.dialog,{version:"1.8.11",uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");if(!a){this.uuid+=1;a=this.uuid}return"ui-dialog-title-"+a},overlay:function(a){this.$el=c.ui.dialog.overlay.create(a)}});c.extend(c.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:c.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),create:function(a){if(this.instances.length===
0){setTimeout(function(){c.ui.dialog.overlay.instances.length&&c(document).bind(c.ui.dialog.overlay.events,function(d){if(c(d.target).zIndex()<c.ui.dialog.overlay.maxZ)return false})},1);c(document).bind("keydown.dialog-overlay",function(d){if(a.options.closeOnEscape&&d.keyCode&&d.keyCode===c.ui.keyCode.ESCAPE){a.close(d);d.preventDefault()}});c(window).bind("resize.dialog-overlay",c.ui.dialog.overlay.resize)}var b=(this.oldInstances.pop()||c("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),
height:this.height()});c.fn.bgiframe&&b.bgiframe();this.instances.push(b);return b},destroy:function(a){var b=c.inArray(a,this.instances);b!=-1&&this.oldInstances.push(this.instances.splice(b,1)[0]);this.instances.length===0&&c([document,window]).unbind(".dialog-overlay");a.remove();var d=0;c.each(this.instances,function(){d=Math.max(d,this.css("z-index"))});this.maxZ=d},height:function(){var a,b;if(c.browser.msie&&c.browser.version<7){a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);
b=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);return a<b?c(window).height()+"px":a+"px"}else return c(document).height()+"px"},width:function(){var a,b;if(c.browser.msie&&c.browser.version<7){a=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);b=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);return a<b?c(window).width()+"px":a+"px"}else return c(document).width()+"px"},resize:function(){var a=c([]);c.each(c.ui.dialog.overlay.instances,
function(){a=a.add(this)});a.css({width:0,height:0}).css({width:c.ui.dialog.overlay.width(),height:c.ui.dialog.overlay.height()})}});c.extend(c.ui.dialog.overlay.prototype,{destroy:function(){c.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
;/*
 * jQuery UI Slider 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Slider
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(d){d.widget("ui.slider",d.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var b=this,a=this.options;this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");a.disabled&&this.element.addClass("ui-slider-disabled ui-disabled");
this.range=d([]);if(a.range){if(a.range===true){this.range=d("<div></div>");if(!a.values)a.values=[this._valueMin(),this._valueMin()];if(a.values.length&&a.values.length!==2)a.values=[a.values[0],a.values[0]]}else this.range=d("<div></div>");this.range.appendTo(this.element).addClass("ui-slider-range");if(a.range==="min"||a.range==="max")this.range.addClass("ui-slider-range-"+a.range);this.range.addClass("ui-widget-header")}d(".ui-slider-handle",this.element).length===0&&d("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");
if(a.values&&a.values.length)for(;d(".ui-slider-handle",this.element).length<a.values.length;)d("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");this.handles=d(".ui-slider-handle",this.element).addClass("ui-state-default ui-corner-all");this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(c){c.preventDefault()}).hover(function(){a.disabled||d(this).addClass("ui-state-hover")},function(){d(this).removeClass("ui-state-hover")}).focus(function(){if(a.disabled)d(this).blur();
else{d(".ui-slider .ui-state-focus").removeClass("ui-state-focus");d(this).addClass("ui-state-focus")}}).blur(function(){d(this).removeClass("ui-state-focus")});this.handles.each(function(c){d(this).data("index.ui-slider-handle",c)});this.handles.keydown(function(c){var e=true,f=d(this).data("index.ui-slider-handle"),h,g,i;if(!b.options.disabled){switch(c.keyCode){case d.ui.keyCode.HOME:case d.ui.keyCode.END:case d.ui.keyCode.PAGE_UP:case d.ui.keyCode.PAGE_DOWN:case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:e=
false;if(!b._keySliding){b._keySliding=true;d(this).addClass("ui-state-active");h=b._start(c,f);if(h===false)return}break}i=b.options.step;h=b.options.values&&b.options.values.length?(g=b.values(f)):(g=b.value());switch(c.keyCode){case d.ui.keyCode.HOME:g=b._valueMin();break;case d.ui.keyCode.END:g=b._valueMax();break;case d.ui.keyCode.PAGE_UP:g=b._trimAlignValue(h+(b._valueMax()-b._valueMin())/5);break;case d.ui.keyCode.PAGE_DOWN:g=b._trimAlignValue(h-(b._valueMax()-b._valueMin())/5);break;case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:if(h===
b._valueMax())return;g=b._trimAlignValue(h+i);break;case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:if(h===b._valueMin())return;g=b._trimAlignValue(h-i);break}b._slide(c,f,g);return e}}).keyup(function(c){var e=d(this).data("index.ui-slider-handle");if(b._keySliding){b._keySliding=false;b._stop(c,e);b._change(c,e);d(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");
this._mouseDestroy();return this},_mouseCapture:function(b){var a=this.options,c,e,f,h,g;if(a.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();c=this._normValueFromMouse({x:b.pageX,y:b.pageY});e=this._valueMax()-this._valueMin()+1;h=this;this.handles.each(function(i){var j=Math.abs(c-h.values(i));if(e>j){e=j;f=d(this);g=i}});if(a.range===true&&this.values(1)===a.min){g+=1;f=d(this.handles[g])}if(this._start(b,
g)===false)return false;this._mouseSliding=true;h._handleIndex=g;f.addClass("ui-state-active").focus();a=f.offset();this._clickOffset=!d(b.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:b.pageX-a.left-f.width()/2,top:b.pageY-a.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(b,g,c);return this._animateOff=true},_mouseStart:function(){return true},
_mouseDrag:function(b){var a=this._normValueFromMouse({x:b.pageX,y:b.pageY});this._slide(b,this._handleIndex,a);return false},_mouseStop:function(b){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(b,this._handleIndex);this._change(b,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(b){var a;
if(this.orientation==="horizontal"){a=this.elementSize.width;b=b.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{a=this.elementSize.height;b=b.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}a=b/a;if(a>1)a=1;if(a<0)a=0;if(this.orientation==="vertical")a=1-a;b=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+a*b)},_start:function(b,a){var c={handle:this.handles[a],value:this.value()};if(this.options.values&&this.options.values.length){c.value=
this.values(a);c.values=this.values()}return this._trigger("start",b,c)},_slide:function(b,a,c){var e;if(this.options.values&&this.options.values.length){e=this.values(a?0:1);if(this.options.values.length===2&&this.options.range===true&&(a===0&&c>e||a===1&&c<e))c=e;if(c!==this.values(a)){e=this.values();e[a]=c;b=this._trigger("slide",b,{handle:this.handles[a],value:c,values:e});this.values(a?0:1);b!==false&&this.values(a,c,true)}}else if(c!==this.value()){b=this._trigger("slide",b,{handle:this.handles[a],
value:c});b!==false&&this.value(c)}},_stop:function(b,a){var c={handle:this.handles[a],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(a);c.values=this.values()}this._trigger("stop",b,c)},_change:function(b,a){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[a],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(a);c.values=this.values()}this._trigger("change",b,c)}},value:function(b){if(arguments.length){this.options.value=
this._trimAlignValue(b);this._refreshValue();this._change(null,0)}return this._value()},values:function(b,a){var c,e,f;if(arguments.length>1){this.options.values[b]=this._trimAlignValue(a);this._refreshValue();this._change(null,b)}if(arguments.length)if(d.isArray(arguments[0])){c=this.options.values;e=arguments[0];for(f=0;f<c.length;f+=1){c[f]=this._trimAlignValue(e[f]);this._change(null,f)}this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(b):this.value();
else return this._values()},_setOption:function(b,a){var c,e=0;if(d.isArray(this.options.values))e=this.options.values.length;d.Widget.prototype._setOption.apply(this,arguments);switch(b){case "disabled":if(a){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.attr("disabled","disabled");this.element.addClass("ui-disabled")}else{this.handles.removeAttr("disabled");this.element.removeClass("ui-disabled")}break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(c=0;c<e;c+=1)this._change(null,c);this._animateOff=false;break}},_value:function(){var b=this.options.value;return b=this._trimAlignValue(b)},_values:function(b){var a,c;if(arguments.length){a=this.options.values[b];
return a=this._trimAlignValue(a)}else{a=this.options.values.slice();for(c=0;c<a.length;c+=1)a[c]=this._trimAlignValue(a[c]);return a}},_trimAlignValue:function(b){if(b<=this._valueMin())return this._valueMin();if(b>=this._valueMax())return this._valueMax();var a=this.options.step>0?this.options.step:1,c=(b-this._valueMin())%a;alignValue=b-c;if(Math.abs(c)*2>=a)alignValue+=c>0?a:-a;return parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},
_refreshValue:function(){var b=this.options.range,a=this.options,c=this,e=!this._animateOff?a.animate:false,f,h={},g,i,j,l;if(this.options.values&&this.options.values.length)this.handles.each(function(k){f=(c.values(k)-c._valueMin())/(c._valueMax()-c._valueMin())*100;h[c.orientation==="horizontal"?"left":"bottom"]=f+"%";d(this).stop(1,1)[e?"animate":"css"](h,a.animate);if(c.options.range===true)if(c.orientation==="horizontal"){if(k===0)c.range.stop(1,1)[e?"animate":"css"]({left:f+"%"},a.animate);
if(k===1)c.range[e?"animate":"css"]({width:f-g+"%"},{queue:false,duration:a.animate})}else{if(k===0)c.range.stop(1,1)[e?"animate":"css"]({bottom:f+"%"},a.animate);if(k===1)c.range[e?"animate":"css"]({height:f-g+"%"},{queue:false,duration:a.animate})}g=f});else{i=this.value();j=this._valueMin();l=this._valueMax();f=l!==j?(i-j)/(l-j)*100:0;h[c.orientation==="horizontal"?"left":"bottom"]=f+"%";this.handle.stop(1,1)[e?"animate":"css"](h,a.animate);if(b==="min"&&this.orientation==="horizontal")this.range.stop(1,
1)[e?"animate":"css"]({width:f+"%"},a.animate);if(b==="max"&&this.orientation==="horizontal")this.range[e?"animate":"css"]({width:100-f+"%"},{queue:false,duration:a.animate});if(b==="min"&&this.orientation==="vertical")this.range.stop(1,1)[e?"animate":"css"]({height:f+"%"},a.animate);if(b==="max"&&this.orientation==="vertical")this.range[e?"animate":"css"]({height:100-f+"%"},{queue:false,duration:a.animate})}}});d.extend(d.ui.slider,{version:"1.8.11"})})(jQuery);
;/*
 * jQuery UI Effects 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/
 */
jQuery.effects||function(f,j){function n(c){var a;if(c&&c.constructor==Array&&c.length==3)return c;if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10)];if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return[parseFloat(a[1])*2.55,parseFloat(a[2])*2.55,parseFloat(a[3])*2.55];if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return[parseInt(a[1],
16),parseInt(a[2],16),parseInt(a[3],16)];if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)];if(/rgba\(0, 0, 0, 0\)/.exec(c))return o.transparent;return o[f.trim(c).toLowerCase()]}function s(c,a){var b;do{b=f.curCSS(c,a);if(b!=""&&b!="transparent"||f.nodeName(c,"body"))break;a="backgroundColor"}while(c=c.parentNode);return n(b)}function p(){var c=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,
a={},b,d;if(c&&c.length&&c[0]&&c[c[0]])for(var e=c.length;e--;){b=c[e];if(typeof c[b]=="string"){d=b.replace(/\-(\w)/g,function(g,h){return h.toUpperCase()});a[d]=c[b]}}else for(b in c)if(typeof c[b]==="string")a[b]=c[b];return a}function q(c){var a,b;for(a in c){b=c[a];if(b==null||f.isFunction(b)||a in t||/scrollbar/.test(a)||!/color/i.test(a)&&isNaN(parseFloat(b)))delete c[a]}return c}function u(c,a){var b={_:0},d;for(d in a)if(c[d]!=a[d])b[d]=a[d];return b}function k(c,a,b,d){if(typeof c=="object"){d=
a;b=null;a=c;c=a.effect}if(f.isFunction(a)){d=a;b=null;a={}}if(typeof a=="number"||f.fx.speeds[a]){d=b;b=a;a={}}if(f.isFunction(b)){d=b;b=null}a=a||{};b=b||a.duration;b=f.fx.off?0:typeof b=="number"?b:b in f.fx.speeds?f.fx.speeds[b]:f.fx.speeds._default;d=d||a.complete;return[c,a,b,d]}function m(c){if(!c||typeof c==="number"||f.fx.speeds[c])return true;if(typeof c==="string"&&!f.effects[c])return true;return false}f.effects={};f.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor",
"borderTopColor","borderColor","color","outlineColor"],function(c,a){f.fx.step[a]=function(b){if(!b.colorInit){b.start=s(b.elem,a);b.end=n(b.end);b.colorInit=true}b.elem.style[a]="rgb("+Math.max(Math.min(parseInt(b.pos*(b.end[0]-b.start[0])+b.start[0],10),255),0)+","+Math.max(Math.min(parseInt(b.pos*(b.end[1]-b.start[1])+b.start[1],10),255),0)+","+Math.max(Math.min(parseInt(b.pos*(b.end[2]-b.start[2])+b.start[2],10),255),0)+")"}});var o={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,
0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,
211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},r=["add","remove","toggle"],t={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};f.effects.animateClass=function(c,a,b,
d){if(f.isFunction(b)){d=b;b=null}return this.queue("fx",function(){var e=f(this),g=e.attr("style")||" ",h=q(p.call(this)),l,v=e.attr("className");f.each(r,function(w,i){c[i]&&e[i+"Class"](c[i])});l=q(p.call(this));e.attr("className",v);e.animate(u(h,l),a,b,function(){f.each(r,function(w,i){c[i]&&e[i+"Class"](c[i])});if(typeof e.attr("style")=="object"){e.attr("style").cssText="";e.attr("style").cssText=g}else e.attr("style",g);d&&d.apply(this,arguments)});h=f.queue(this);l=h.splice(h.length-1,1)[0];
h.splice(1,0,l);f.dequeue(this)})};f.fn.extend({_addClass:f.fn.addClass,addClass:function(c,a,b,d){return a?f.effects.animateClass.apply(this,[{add:c},a,b,d]):this._addClass(c)},_removeClass:f.fn.removeClass,removeClass:function(c,a,b,d){return a?f.effects.animateClass.apply(this,[{remove:c},a,b,d]):this._removeClass(c)},_toggleClass:f.fn.toggleClass,toggleClass:function(c,a,b,d,e){return typeof a=="boolean"||a===j?b?f.effects.animateClass.apply(this,[a?{add:c}:{remove:c},b,d,e]):this._toggleClass(c,
a):f.effects.animateClass.apply(this,[{toggle:c},a,b,d])},switchClass:function(c,a,b,d,e){return f.effects.animateClass.apply(this,[{add:a,remove:c},b,d,e])}});f.extend(f.effects,{version:"1.8.11",save:function(c,a){for(var b=0;b<a.length;b++)a[b]!==null&&c.data("ec.storage."+a[b],c[0].style[a[b]])},restore:function(c,a){for(var b=0;b<a.length;b++)a[b]!==null&&c.css(a[b],c.data("ec.storage."+a[b]))},setMode:function(c,a){if(a=="toggle")a=c.is(":hidden")?"show":"hide";return a},getBaseline:function(c,
a){var b;switch(c[0]){case "top":b=0;break;case "middle":b=0.5;break;case "bottom":b=1;break;default:b=c[0]/a.height}switch(c[1]){case "left":c=0;break;case "center":c=0.5;break;case "right":c=1;break;default:c=c[1]/a.width}return{x:c,y:b}},createWrapper:function(c){if(c.parent().is(".ui-effects-wrapper"))return c.parent();var a={width:c.outerWidth(true),height:c.outerHeight(true),"float":c.css("float")},b=f("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",
border:"none",margin:0,padding:0});c.wrap(b);b=c.parent();if(c.css("position")=="static"){b.css({position:"relative"});c.css({position:"relative"})}else{f.extend(a,{position:c.css("position"),zIndex:c.css("z-index")});f.each(["top","left","bottom","right"],function(d,e){a[e]=c.css(e);if(isNaN(parseInt(a[e],10)))a[e]="auto"});c.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}return b.css(a).show()},removeWrapper:function(c){if(c.parent().is(".ui-effects-wrapper"))return c.parent().replaceWith(c);
return c},setTransition:function(c,a,b,d){d=d||{};f.each(a,function(e,g){unit=c.cssUnit(g);if(unit[0]>0)d[g]=unit[0]*b+unit[1]});return d}});f.fn.extend({effect:function(c){var a=k.apply(this,arguments),b={options:a[1],duration:a[2],callback:a[3]};a=b.options.mode;var d=f.effects[c];if(f.fx.off||!d)return a?this[a](b.duration,b.callback):this.each(function(){b.callback&&b.callback.call(this)});return d.call(this,b)},_show:f.fn.show,show:function(c){if(m(c))return this._show.apply(this,arguments);
else{var a=k.apply(this,arguments);a[1].mode="show";return this.effect.apply(this,a)}},_hide:f.fn.hide,hide:function(c){if(m(c))return this._hide.apply(this,arguments);else{var a=k.apply(this,arguments);a[1].mode="hide";return this.effect.apply(this,a)}},__toggle:f.fn.toggle,toggle:function(c){if(m(c)||typeof c==="boolean"||f.isFunction(c))return this.__toggle.apply(this,arguments);else{var a=k.apply(this,arguments);a[1].mode="toggle";return this.effect.apply(this,a)}},cssUnit:function(c){var a=this.css(c),
b=[];f.each(["em","px","%","pt"],function(d,e){if(a.indexOf(e)>0)b=[parseFloat(a),e]});return b}});f.easing.jswing=f.easing.swing;f.extend(f.easing,{def:"easeOutQuad",swing:function(c,a,b,d,e){return f.easing[f.easing.def](c,a,b,d,e)},easeInQuad:function(c,a,b,d,e){return d*(a/=e)*a+b},easeOutQuad:function(c,a,b,d,e){return-d*(a/=e)*(a-2)+b},easeInOutQuad:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a+b;return-d/2*(--a*(a-2)-1)+b},easeInCubic:function(c,a,b,d,e){return d*(a/=e)*a*a+b},easeOutCubic:function(c,
a,b,d,e){return d*((a=a/e-1)*a*a+1)+b},easeInOutCubic:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a+b;return d/2*((a-=2)*a*a+2)+b},easeInQuart:function(c,a,b,d,e){return d*(a/=e)*a*a*a+b},easeOutQuart:function(c,a,b,d,e){return-d*((a=a/e-1)*a*a*a-1)+b},easeInOutQuart:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a*a+b;return-d/2*((a-=2)*a*a*a-2)+b},easeInQuint:function(c,a,b,d,e){return d*(a/=e)*a*a*a*a+b},easeOutQuint:function(c,a,b,d,e){return d*((a=a/e-1)*a*a*a*a+1)+b},easeInOutQuint:function(c,
a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a*a*a+b;return d/2*((a-=2)*a*a*a*a+2)+b},easeInSine:function(c,a,b,d,e){return-d*Math.cos(a/e*(Math.PI/2))+d+b},easeOutSine:function(c,a,b,d,e){return d*Math.sin(a/e*(Math.PI/2))+b},easeInOutSine:function(c,a,b,d,e){return-d/2*(Math.cos(Math.PI*a/e)-1)+b},easeInExpo:function(c,a,b,d,e){return a==0?b:d*Math.pow(2,10*(a/e-1))+b},easeOutExpo:function(c,a,b,d,e){return a==e?b+d:d*(-Math.pow(2,-10*a/e)+1)+b},easeInOutExpo:function(c,a,b,d,e){if(a==0)return b;if(a==
e)return b+d;if((a/=e/2)<1)return d/2*Math.pow(2,10*(a-1))+b;return d/2*(-Math.pow(2,-10*--a)+2)+b},easeInCirc:function(c,a,b,d,e){return-d*(Math.sqrt(1-(a/=e)*a)-1)+b},easeOutCirc:function(c,a,b,d,e){return d*Math.sqrt(1-(a=a/e-1)*a)+b},easeInOutCirc:function(c,a,b,d,e){if((a/=e/2)<1)return-d/2*(Math.sqrt(1-a*a)-1)+b;return d/2*(Math.sqrt(1-(a-=2)*a)+1)+b},easeInElastic:function(c,a,b,d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e)==1)return b+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;c=g/4}else c=
g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g))+b},easeOutElastic:function(c,a,b,d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e)==1)return b+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;c=g/4}else c=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*a)*Math.sin((a*e-c)*2*Math.PI/g)+d+b},easeInOutElastic:function(c,a,b,d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e/2)==2)return b+d;g||(g=e*0.3*1.5);if(h<Math.abs(d)){h=d;c=g/4}else c=g/(2*Math.PI)*Math.asin(d/
h);if(a<1)return-0.5*h*Math.pow(2,10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g)+b;return h*Math.pow(2,-10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g)*0.5+d+b},easeInBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;return d*(a/=e)*a*((g+1)*a-g)+b},easeOutBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;return d*((a=a/e-1)*a*((g+1)*a+g)+1)+b},easeInOutBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;if((a/=e/2)<1)return d/2*a*a*(((g*=1.525)+1)*a-g)+b;return d/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+b},easeInBounce:function(c,
a,b,d,e){return d-f.easing.easeOutBounce(c,e-a,0,d,e)+b},easeOutBounce:function(c,a,b,d,e){return(a/=e)<1/2.75?d*7.5625*a*a+b:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+0.75)+b:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+0.9375)+b:d*(7.5625*(a-=2.625/2.75)*a+0.984375)+b},easeInOutBounce:function(c,a,b,d,e){if(a<e/2)return f.easing.easeInBounce(c,a*2,0,d,e)*0.5+b;return f.easing.easeOutBounce(c,a*2-e,0,d,e)*0.5+d*0.5+b}})}(jQuery);
;/*
 * jQuery UI Effects Slide 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Slide
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(c){c.effects.slide=function(d){return this.queue(function(){var a=c(this),h=["position","top","bottom","left","right"],f=c.effects.setMode(a,d.options.mode||"show"),b=d.options.direction||"left";c.effects.save(a,h);a.show();c.effects.createWrapper(a).css({overflow:"hidden"});var g=b=="up"||b=="down"?"top":"left";b=b=="up"||b=="left"?"pos":"neg";var e=d.options.distance||(g=="top"?a.outerHeight({margin:true}):a.outerWidth({margin:true}));if(f=="show")a.css(g,b=="pos"?isNaN(e)?"-"+e:-e:e);
var i={};i[g]=(f=="show"?b=="pos"?"+=":"-=":b=="pos"?"-=":"+=")+e;a.animate(i,{queue:false,duration:d.duration,easing:d.options.easing,complete:function(){f=="hide"&&a.hide();c.effects.restore(a,h);c.effects.removeWrapper(a);d.callback&&d.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
;/*
 * jQuery UI Effects Transfer 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Transfer
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(e){e.effects.transfer=function(a){return this.queue(function(){var b=e(this),c=e(a.options.to),d=c.offset();c={top:d.top,left:d.left,height:c.innerHeight(),width:c.innerWidth()};d=b.offset();var f=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(a.options.className).css({top:d.top,left:d.left,height:b.innerHeight(),width:b.innerWidth(),position:"absolute"}).animate(c,a.duration,a.options.easing,function(){f.remove();a.callback&&a.callback.apply(b[0],arguments);
b.dequeue()})})}})(jQuery);
;;
/*!
 * jQuery dragscrollable Plugin
 * version: 1.0 (25-Jun-2009)
 * Copyright (c) 2009 Miquel Herrera
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Modified by David Richard (2011)
 *   - added delegateMode option
 */
(function(a){a.fn.dragscrollable=function(b){var c=a.extend({dragSelector:">:first",acceptPropagatedEvent:!0,preventDefault:!0,delegateMode:!1},b||{}),d={mouseDownHandler:function(b){if(b.which!=1)return!1;if(!b.data.acceptPropagatedEvent){if(b.target.localName=="input"||b.target.localName=="textarea")return!0;if(b.target!=this)return!1}b.data.lastCoord={left:b.clientX,top:b.clientY},a.event.add(document,"mouseup",d.mouseUpHandler,b.data),a.event.add(document,"mousemove",d.mouseMoveHandler,b.data);if(b.data.preventDefault)return b.preventDefault(),!1},mouseMoveHandler:function(a){var b={left:a.clientX-a.data.lastCoord.left,top:a.clientY-a.data.lastCoord.top};a.data.scrollable.scrollLeft(a.data.scrollable.scrollLeft()-b.left),a.data.scrollable.scrollTop(a.data.scrollable.scrollTop()-b.top),a.data.lastCoord={left:a.clientX,top:a.clientY};if(a.data.preventDefault)return a.preventDefault(),!1},mouseUpHandler:function(b){a.event.remove(document,"mousemove",d.mouseMoveHandler),a.event.remove(document,"mouseup",d.mouseUpHandler);if(b.data.preventDefault)return b.preventDefault(),!1}};this.each(function(){var b={scrollable:a(this),acceptPropagatedEvent:c.acceptPropagatedEvent,preventDefault:c.preventDefault};c.delegateMode?a(this).delegate(c.dragSelector,"mousedown",b,d.mouseDownHandler):a(this).find(c.dragSelector).bind("mousedown",b,d.mouseDownHandler)})}})(jQuery);
/*!
 * jQuery Hotkeys Plugin
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Based upon the plugin by Tzury Bar Yochay:
 * http://github.com/tzuryby/hotkeys
 *
 * Original idea by:
 * Binny V A, http://www.openjs.com/scripts/events/keyboard_shortcuts/
*/
(function(a){function b(b){if(typeof b.data!="string")return;var c=b.handler,d=b.data.toLowerCase().split(" ");b.handler=function(b){if(!(this===b.target||!/textarea|select/i.test(b.target.nodeName)&&b.target.type!=="text"))return;var e=b.type!=="keypress"&&a.hotkeys.specialKeys[b.which],f=String.fromCharCode(b.which).toLowerCase(),g,h="",i={};b.altKey&&e!=="alt"&&(h+="alt+"),b.ctrlKey&&e!=="ctrl"&&(h+="ctrl+"),b.metaKey&&!b.ctrlKey&&e!=="meta"&&(h+="meta+"),b.shiftKey&&e!=="shift"&&(h+="shift+"),e?i[h+e]=!0:(i[h+f]=!0,i[h+a.hotkeys.shiftNums[f]]=!0,h==="shift+"&&(i[a.hotkeys.shiftNums[f]]=!0));for(var j=0,k=d.length;j<k;j++)if(i[d[j]])return c.apply(this,arguments)}}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:b}})})(jQuery);
/*! Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.4
 * 
 * Requires: 1.2.2+
 */
(function(a){function c(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",b.wheelDelta&&(e=b.wheelDelta/120),b.detail&&(e=-b.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/120),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),a.event.handle.apply(this,d)}var b=["DOMMouseScroll","mousewheel"];a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],c,!1);else this.onmousewheel=c},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],c,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);
/*!
 * jQuery miniColors: A small color selector
 *
 * Copyright 2011 Cory LaViska for A Beautiful Site, LLC. (http://abeautifulsite.net/)
 *
 * Dual licensed under the MIT or GPL Version 2 licenses
 *
 */
jQuery&&function(a){a.extend(a.fn,{miniColors:function(b,c){var d=function(b,c,d){var e=q(b.val());e||(e="FFFFFF");var f=v(e),h=a('<a class="miniColors-trigger" style="background-color: #'+e+'" href="#"></a>');h.insertAfter(b),b.addClass("miniColors").attr("maxlength",7).attr("autocomplete","off"),b.data("trigger",h),b.data("hsb",f),c.change&&b.data("change",c.change),c.hide&&b.data("hide",c.hide),c.move&&b.data("move",c.move),c.readonly&&b.attr("readonly",!0),c.disabled&&g(b),h.bind("click.miniColors",function(a){a.preventDefault(),b.trigger("focus")}),b.bind("focus.miniColors",function(a){i(b)}),b.bind("blur.miniColors",function(a){var c=q(b.val());b.val(c?"#"+c:"")}),b.bind("keydown.miniColors",function(a){a.keyCode===9&&j(b)}),b.bind("keyup.miniColors",function(a){var c=b.val().replace(/[^A-F0-9#]/ig,"");b.val(c),n(b)||b.data("trigger").css("backgroundColor","#FFF")}),b.bind("paste.miniColors",function(a){setTimeout(function(){b.trigger("keyup")},5)})},e=function(b){j(),b=a(b),b.data("trigger").remove(),b.removeAttr("autocomplete"),b.removeData("trigger"),b.removeData("selector"),b.removeData("hsb"),b.removeData("huePicker"),b.removeData("colorPicker"),b.removeData("mousebutton"),b.removeData("moving"),b.unbind("click.miniColors"),b.unbind("focus.miniColors"),b.unbind("blur.miniColors"),b.unbind("keyup.miniColors"),b.unbind("keydown.miniColors"),b.unbind("paste.miniColors")},f=function(a){a.attr("disabled",!1),a.data("trigger").css("opacity",1)},g=function(a){a.attr("disabled",!0),a.data("trigger").css("opacity",.5),j(a)},i=function(b){if(b.attr("disabled"))return!1;j();var c=a('<div class="miniColors-selector"></div>');c.append('<div class="miniColors-colors" style="background-color: #FFF;"><div class="miniColors-colorPicker"></div></div>'),c.append('<div class="miniColors-hues"><div class="miniColors-huePicker"></div></div>'),c.css({top:b.is(":visible")?b.offset().top+b.outerHeight():b.data("trigger").offset().top+b.data("trigger").outerHeight(),left:b.is(":visible")?b.offset().left:b.data("trigger").offset().left-87,display:"none"}).addClass(b.attr("class"));var d=b.data("hsb");c.find(".miniColors-colors").css("backgroundColor","#"+w({h:d.h,s:100,b:100}));var e=b.data("colorPosition");e||(e=o(d)),c.find(".miniColors-colorPicker").css("top",e.y+"px").css("left",e.x+"px");var f=b.data("huePosition");f||(f=p(d)),c.find(".miniColors-huePicker").css("top",f.y+"px"),b.data("selector",c),b.data("huePicker",c.find(".miniColors-huePicker")),b.data("colorPicker",c.find(".miniColors-colorPicker")),b.data("mousebutton",0);var g=a("<div class='miniColors-overlay no-select'/>").css({position:"absolute",left:0,top:0,width:"100%",height:"100%","z-index":1e4}).appendTo("BODY").mousedown(function(){j(b),g.remove()});a("BODY").append(c),c.fadeIn(100),c.bind("selectstart",function(){return!1}),c.bind("mousedown.miniColors",function(c){b.data("mousebutton",1),a(c.target).hasClass("miniColors-colors")&&(c.preventDefault(),b.data("moving","colors"),k(b,c)),a(c.target).hasClass("miniColors-hues")&&(c.preventDefault(),b.data("moving","hues"),l(b,c)),b.data("move")&&b.data("move").call(b,b.val())}),c.bind("mouseup.miniColors",function(a){b.data("mousebutton",0),b.removeData("moving")}),c.bind("mousemove.miniColors",function(a){b.data("mousebutton")===1&&(b.data("moving")==="colors"&&k(b,a),b.data("moving")==="hues"&&l(b,a),b.data("move")&&b.data("move").call(b,b.val()))})},j=function(b){b&&b.data("hide")&&b.data("hide").call(b,b.val()),b||(b=".miniColors"),a(b).each(function(){var b=a(this).data("selector");a(this).removeData("selector"),a(b).fadeOut(100,function(){a(this).remove()})})},k=function(b,c){var d=b.data("colorPicker");d.hide();var e={x:c.clientX-b.data("selector").find(".miniColors-colors").offset().left+a(document).scrollLeft()-5,y:c.clientY-b.data("selector").find(".miniColors-colors").offset().top+a(document).scrollTop()-5};e.x<=-5&&(e.x=-5),e.x>=144&&(e.x=144),e.y<=-5&&(e.y=-5),e.y>=144&&(e.y=144),b.data("colorPosition",e),d.css("left",e.x).css("top",e.y).show();var f=Math.round((e.x+5)*.67);f<0&&(f=0),f>100&&(f=100);var g=100-Math.round((e.y+5)*.67);g<0&&(g=0),g>100&&(g=100);var h=b.data("hsb");h.s=f,h.b=g,m(b,h,!0)},l=function(b,c){var d=b.data("huePicker");d.hide();var e={y:c.clientY-b.data("selector").find(".miniColors-colors").offset().top+a(document).scrollTop()-1};e.y<=-1&&(e.y=-1),e.y>=149&&(e.y=149),b.data("huePosition",e),d.css("top",e.y).show();var f=Math.round((150-e.y-1)*2.4);f<0&&(f=0),f>360&&(f=360);var g=b.data("hsb");g.h=f,m(b,g,!0)},m=function(a,b,c){a.data("hsb",b);var d=w(b);c&&a.val("#"+d),a.data("trigger").css("backgroundColor","#"+d),a.data("selector")&&a.data("selector").find(".miniColors-colors").css("backgroundColor","#"+w({h:b.h,s:100,b:100})),a.data("change")&&a.data("change").call(a,"#"+d,r(b))},n=function(b){var c=q(b.val());if(!c)return!1;var d=v(c),e=b.data("hsb");if(d.h===e.h&&d.s===e.s&&d.b===e.b)return!0;var f=o(d),g=a(b.data("colorPicker"));g.css("top",f.y+"px").css("left",f.x+"px");var h=p(d),i=a(b.data("huePicker"));return i.css("top",h.y+"px"),m(b,d,!1),!0},o=function(a){var b=Math.ceil(a.s/.67);b<0&&(b=0),b>150&&(b=150);var c=150-Math.ceil(a.b/.67);return c<0&&(c=0),c>150&&(c=150),{x:b-5,y:c-5}},p=function(a){var b=150-a.h/2.4;return b<0&&(h=0),b>150&&(h=150),{y:b-1}},q=function(a){return a=a.replace(/[^A-Fa-f0-9]/,""),a.length==3&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),a.length===6?a:null},r=function(a){var b={},c=Math.round(a.h),d=Math.round(a.s*255/100),e=Math.round(a.b*255/100);if(d==0)b.r=b.g=b.b=e;else{var f=e,g=(255-d)*e/255,h=(f-g)*(c%60)/60;c==360&&(c=0),c<60?(b.r=f,b.b=g,b.g=g+h):c<120?(b.g=f,b.b=g,b.r=f-h):c<180?(b.g=f,b.r=g,b.b=g+h):c<240?(b.b=f,b.r=g,b.g=f-h):c<300?(b.b=f,b.g=g,b.r=g+h):c<360?(b.r=f,b.g=g,b.b=f-h):(b.r=0,b.g=0,b.b=0)}return{r:Math.round(b.r),g:Math.round(b.g),b:Math.round(b.b)}},s=function(b){var c=[b.r.toString(16),b.g.toString(16),b.b.toString(16)];return a.each(c,function(a,b){b.length==1&&(c[a]="0"+b)}),c.join("")},t=function(a){var a=parseInt(a.indexOf("#")>-1?a.substring(1):a,16);return{r:a>>16,g:(a&65280)>>8,b:a&255}},u=function(a){var b={h:0,s:0,b:0},c=Math.min(a.r,a.g,a.b),d=Math.max(a.r,a.g,a.b),e=d-c;return b.b=d,b.s=d!=0?255*e/d:0,b.s!=0?a.r==d?b.h=(a.g-a.b)/e:a.g==d?b.h=2+(a.b-a.r)/e:b.h=4+(a.r-a.g)/e:b.h=-1,b.h*=60,b.h<0&&(b.h+=360),b.s*=100/255,b.b*=100/255,b},v=function(a){var b=u(t(a));return b.s===0&&(b.h=360),b},w=function(a){return s(r(a))};switch(b){case"readonly":return a(this).each(function(){a(this).attr("readonly",c)}),a(this);case"disabled":return a(this).each(function(){c?g(a(this)):f(a(this))}),a(this);case"value":return a(this).each(function(){a(this).val(c).trigger("keyup")}),a(this);case"destroy":return a(this).each(function(){e(a(this))}),a(this);default:return b||(b={}),a(this).each(function(){if(a(this)[0].tagName.toLowerCase()!=="input")return;if(a(this).data("trigger"))return;d(a(this),b,c)}),a(this)}}})}(jQuery);
/*!
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(a,b){function m(b,c,d,e){var h={data:e||e===0||e===!1?e:c?c.data:{},_wrap:c?c._wrap:null,tmpl:null,parent:c||null,nodes:[],calls:u,nest:v,wrap:w,html:x,update:y};return b&&a.extend(h,b,{nodes:[],parent:c}),d&&(h.tmpl=d,h._ctnt=h._ctnt||h.tmpl(a,h),h.key=++j,(l.length?g:f)[j]=h),h}function n(b,c,e){var f,g=e?a.map(e,function(a){return typeof a=="string"?b.key?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+d+'="'+b.key+'" $2'):a:n(a,b,a._ctnt)}):b;return c?g:(g=g.join(""),g.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(b,c,d,e){f=a(d).get(),t(f),c&&(f=o(c).concat(f)),e&&(f=f.concat(o(e)))}),f?f:o(g))}function o(b){var c=document.createElement("div");return c.innerHTML=b,a.makeArray(c.childNodes)}function p(b){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(b,c,d,e,f,g,h){var i=a.tmpl.tag[d],j,k,l;if(!i)throw"Unknown template tag: "+d;return j=i._default||[],g&&!/\w$/.test(f)&&(f+=g,g=""),f?(f=r(f),h=h?","+r(h)+")":g?")":"",k=g?f.indexOf(".")>-1?f+r(g):"("+f+").call($item"+h:f,l=g?k:"(typeof("+f+")==='function'?("+f+").call($item):("+f+"))"):l=k=j.$1||"null",e=r(e),"');"+i[c?"close":"open"].split("$notnull_1").join(f?"typeof("+f+")!=='undefined' && ("+f+")!=null":"true").split("$1a").join(l).split("$1").join(k).split("$2").join(e||j.$2||"")+"__.push('"})+"');}return __;")}function q(b,c){b._wrap=n(b,!0,a.isArray(c)?c:[e.test(c)?c:a(c).html()]).join("")}function r(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function s(a){var b=document.createElement("div");return b.appendChild(a.cloneNode(!0)),b.innerHTML}function t(b){function p(b){function p(a){a+=c,n=i[a]=i[a]||m(n,f[n.parent.key+c]||n.parent)}var e,h=b,l,n,o;if(o=b.getAttribute(d)){while(h.parentNode&&(h=h.parentNode).nodeType===1&&!(e=h.getAttribute(d)));e!==o&&(h=h.parentNode?h.nodeType===11?0:h.getAttribute(d)||0:0,(n=f[o])||(n=g[o],n=m(n,f[h]||g[h]),n.key=++j,f[j]=n),k&&p(o)),b.removeAttribute(d)}else k&&(n=a.data(b,"tmplItem"))&&(p(n.key),f[n.key]=n,h=a.data(b.parentNode,"tmplItem"),h=h?h.key:0);if(n){l=n;while(l&&l.key!=h)l.nodes.push(b),l=l.parent;delete n._ctnt,delete n._wrap,a.data(b,"tmplItem",n)}}var c="_"+k,e,h,i={},l,n,o;for(l=0,n=b.length;l<n;l++){if((e=b[l]).nodeType!==1)continue;h=e.getElementsByTagName("*");for(o=h.length-1;o>=0;o--)p(h[o]);p(e)}}function u(a,b,c,d){if(!a)return l.pop();l.push({_:a,tmpl:b,item:this,data:c,options:d})}function v(b,c,d){return a.tmpl(a.template(b),c,d,this)}function w(b,c){var d=b.options||{};return d.wrapped=c,a.tmpl(a.template(b.tmpl),b.data,d,b.item)}function x(b,c){var d=this._wrap;return a.map(a(a.isArray(d)?d.join(""):d).filter(b||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||s(a)})}function y(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]),a(b).remove()}var c=a.fn.domManip,d="_tmplitem",e=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,f={},g={},h,i={key:0,data:{}},j=0,k=0,l=[];a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){a.fn[b]=function(d){var e=[],g=a(d),i,j,l,m,n=this.length===1&&this[0].parentNode;h=f||{};if(n&&n.nodeType===11&&n.childNodes.length===1&&g.length===1)g[c](this[0]),e=this;else{for(j=0,l=g.length;j<l;j++)k=j,i=(j>0?this.clone(!0):this).get(),a(g[j])[c](i),e=e.concat(i);k=0,e=this.pushStack(e,b,g.selector)}return m=h,h=null,a.tmpl.complete(m),e}}),a.fn.extend({tmpl:function(b,c,d){return a.tmpl(this[0],b,c,d)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(b,d,e,g){if(b[0]&&a.isArray(b[0])){var i=a.makeArray(arguments),j=b[0],l=j.length,m=0,n;while(m<l&&!(n=a.data(j[m++],"tmplItem")));n&&k&&(i[2]=function(b){a.tmpl.afterManip(this,b,e)}),c.apply(this,i)}else c.apply(this,arguments);return k=0,h||a.tmpl.complete(f),this}}),a.extend({tmpl:function(b,c,d,e){var h,j=!e;if(j)e=i,b=a.template[b]||a.template(null,b),g={};else if(!b)return b=e.tmpl,f[e.key]=e,e.nodes=[],e.wrapped&&q(e,e.wrapped),a(n(e,null,e.tmpl(a,e)));return b?(typeof c=="function"&&(c=c.call(e||{})),d&&d.wrapped&&q(d,d.wrapped),h=a.isArray(c)?a.map(c,function(a){return a?m(d,e,b,a):null}):[m(d,e,b,c)],j?a(n(e,null,h)):h):[]},tmplItem:function(b){var c;b instanceof a&&(b=b[0]);while(b&&b.nodeType===1&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode));return c||i},template:function(b,c){return c?(typeof c=="string"?c=p(c):c instanceof a&&(c=c[0]||{}),c.nodeType&&(c=a.data(c,"tmpl")||a.data(c,"tmpl",p(c.innerHTML))),typeof b=="string"?a.template[b]=c:c):b?typeof b!="string"?a.template(null,b):a.template[b]||a.template(null,e.test(b)?b:a(b)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(a){f={}},afterManip:function(c,d,e){var f=d.nodeType===11?a.makeArray(d.childNodes):d.nodeType===1?[d]:[];e.call(c,d),t(f),k++}})})(jQuery);
/*!
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
var EventEmitter=function(){};EventEmitter.prototype.setMaxListeners=function(a){this._events||(this._events={}),this._events.maxListeners=a},EventEmitter.prototype.emit=function(a){if(a==="error")if(!this._events||!this._events.error||Array.isArray(this._events.error)&&!this._events.error.length)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var b=this._events[a];if(!b)return!1;if(typeof b=="function"){switch(arguments.length){case 1:b.call(this);break;case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;default:var c=Array.prototype.slice.call(arguments,1);b.apply(this,c)}return!0}if(Array.isArray(b)){var c=Array.prototype.slice.call(arguments,1),d=b.slice();for(var e=0,f=d.length;e<f;e++)d[e].apply(this,c);return!0}return!1},EventEmitter.prototype.publish=EventEmitter.prototype.emit,EventEmitter.prototype.addListener=function(a,b){if("function"!=typeof b)throw new Error("addListener only takes instances of Function");this._events||(this._events={}),this.emit("newListener",a,b);if(!this._events[a])this._events[a]=b;else if(Array.isArray(this._events[a])){this._events[a].push(b);if(!this._events[a].warned){var c;this._events.maxListeners!==undefined?c=this._events.maxListeners:c=10,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace())}}else this._events[a]=[this._events[a],b];return this},EventEmitter.prototype.on=EventEmitter.prototype.subscribe=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(a,b){function d(){c.removeListener(a,d),b.apply(this,arguments)}if("function"!=typeof b)throw new Error(".once only takes instances of Function");var c=this;return d.listener=b,c.on(a,d),this},EventEmitter.prototype.removeListener=function(a,b){if("function"!=typeof b)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[a])return this;var c=this._events[a];if(Array.isArray(c)){var d=-1;for(var e=0,f=c.length;e<f;e++)if(c[e]===b||c[e].listener&&c[e].listener===b){d=e;break}if(d<0)return this;c.splice(d,1),c.length==0&&delete this._events[a]}else(c===b||c.listener&&c.listener===b)&&delete this._events[a];return this},EventEmitter.prototype.unsubscribe=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(a){return arguments.length===0?(this._events={},this):(a&&this._events&&this._events[a]&&(this._events[a]=null),this)},EventEmitter.prototype.listeners=function(a){return this._events||(this._events={}),this._events[a]||(this._events[a]=[]),Array.isArray(this._events[a])||(this._events[a]=[this._events[a]]),this._events[a]},EventEmitter.mixin=function(a){for(var b in EventEmitter.prototype)a.prototype[b]||(a.prototype[b]=EventEmitter.prototype[b])};
/*!
 *  mindmaps - a HTML5 powered mind mapping application
 *  Copyright (C) 2011  David Richard
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as
 *  published by the Free Software Foundation, either version 3 of the
 *  License, or (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
function removeEventLayerXY(){var a=$.event.props,b=a.length,c=[];while(b--){var d=a[b];d!="layerX"&&d!="layerY"&&c.push(d)}$.event.props=c}function addUnloadHook(){window.onbeforeunload=function(a){var b="Are you sure? Any unsaved progress will be lost.";return a=a||window.event,a&&(a.returnValue=b),b}}function trackErrors(){window.onerror=function(a,b,c){if(!window._gaq)return;return _gaq.push(["_trackEvent","Error Log",a,b+"_"+c]),!1}}function setupConsole(){var a=function(){},b=window.console||{};["log","info","debug","warn","error"].forEach(function(c){b[c]=b[c]||a}),mindmaps.DEBUG||(b.debug=a,b.info=a,b.log=a,b.warn=a,b.error=function(a){window.alert("Error: "+a)}),window.console=b}function createECMA5Shims(){if(!Function.prototype.bind){var a=Array.prototype.slice;Function.prototype.bind=function(c){function f(){if(this instanceof f){var b=Object.create(d.prototype);return d.apply(b,e.concat(a.call(arguments))),b}return d.call.apply(d,e.concat(a.call(arguments)))}var d=this;if(typeof d.apply!="function"||typeof d.call!="function")return new TypeError;var e=a.call(arguments);return f.length=typeof d=="function"?Math.max(d.length-e.length,0):0,f}}Array.isArray||(Array.isArray=function(b){return Object.prototype.toString.call(b)==="[object Array]"}),Array.prototype.forEach||(Array.prototype.forEach=function(b,c){var d=+this.length;for(var e=0;e<d;e++)e in this&&b.call(c,this[e],e,this)}),Array.prototype.map||(Array.prototype.map=function(b){var c=+this.length;if(typeof b!="function")throw new TypeError;var d=new Array(c),e=arguments[1];for(var f=0;f<c;f++)f in this&&(d[f]=b.call(e,this[f],f,this));return d}),Array.prototype.filter||(Array.prototype.filter=function(b){var c=[],d=arguments[1];for(var e=0;e<this.length;e++)b.call(d,this[e])&&c.push(this[e]);return c}),Array.prototype.every||(Array.prototype.every=function(b){var c=arguments[1];for(var d=0;d<this.length;d++)if(!b.call(c,this[d]))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(b){var c=arguments[1];for(var d=0;d<this.length;d++)if(b.call(c,this[d]))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(b){var c=+this.length;if(typeof b!="function")throw new TypeError;if(c===0&&arguments.length===1)throw new TypeError;var d=0;if(arguments.length>=2)var e=arguments[1];else do{if(d in this){e=this[d++];break}if(++d>=c)throw new TypeError}while(!0);for(;d<c;d++)d in this&&(e=b.call(null,e,this[d],d,this));return e}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(b){var c=+this.length;if(typeof b!="function")throw new TypeError;if(c===0&&arguments.length===1)throw new TypeError;var d,e=c-1;if(arguments.length>=2)d=arguments[1];else do{if(e in this){d=this[e--];break}if(--e<0)throw new TypeError}while(!0);for(;e>=0;e--)e in this&&(d=b.call(null,d,this[e],e,this));return d}),Array.prototype.indexOf||(Array.prototype.indexOf=function(b){var c=this.length;if(!c)return-1;var d=arguments[1]||0;if(d>=c)return-1;d<0&&(d+=c);for(;d<c;d++){if(!(d in this))continue;if(b===this[d])return d}return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(b){var c=this.length;if(!c)return-1;var d=arguments[1]||c;d<0&&(d+=c),d=Math.min(d,c-1);for(;d>=0;d--){if(!(d in this))continue;if(b===this[d])return d}return-1}),Date.now||(Date.now=function(){return(new Date).getTime()})}function createHTML5Shims(){typeof window.localStorage=="undefined"&&(window.localStorage={getItem:function(){return null},setItem:function(){},clear:function(){},removeItem:function(){},length:0,key:function(){return null}})}"use strict";var mindmaps=mindmaps||{};mindmaps.VERSION="0.7.2",window.addEventListener("load",function(a){window.applicationCache.addEventListener("updateready",function(a){window.applicationCache.status==window.applicationCache.UPDATEREADY&&(window.applicationCache.swapCache(),window.onbeforeunload=null,confirm("A new version of the app is available. Load it?")&&window.location.reload())},!1)},!1),$(function(){removeEventLayerXY(),createECMA5Shims(),createHTML5Shims(),setupConsole(),trackErrors(),mindmaps.DEBUG||addUnloadHook();var a=new mindmaps.ApplicationController;a.go()}),$(function(){$("#bottombar table").remove(),$("input[name='hosted_button_id']").val("123")});
mindmaps.Command=function(){this.id="BASE_COMMAND",this.shortcut=null,this.handler=null,this.label=null,this.description=null,this.enabled=!1},mindmaps.Command.Event={HANDLER_REGISTERED:"HandlerRegisteredCommandEvent",HANDLER_REMOVED:"HandlerRemovedCommandEvent",ENABLED_CHANGED:"EnabledChangedCommandEvent"},mindmaps.Command.prototype={execute:function(){this.handler?(this.handler(),mindmaps.DEBUG&&console.log("handler called for",this.id)):mindmaps.DEBUG&&console.log("no handler found for",this.id)},setHandler:function(a){this.removeHandler(),this.handler=a,this.publish(mindmaps.Command.Event.HANDLER_REGISTERED)},removeHandler:function(){this.handler=null,this.publish(mindmaps.Command.Event.HANDLER_REMOVED)},setEnabled:function(a){this.enabled=a,this.publish(mindmaps.Command.Event.ENABLED_CHANGED,a)}},EventEmitter.mixin(mindmaps.Command),mindmaps.CreateNodeCommand=function(){this.id="CREATE_NODE_COMMAND",this.shortcut="tab",this.label="Add",this.icon="ui-icon-plusthick",this.description="Creates a new node"},mindmaps.CreateNodeCommand.prototype=new mindmaps.Command,mindmaps.CreateSiblingNodeCommand=function(){this.id="CREATE_SIBLING_NODE_COMMAND",this.shortcut="shift+tab",this.label="Add",this.icon="ui-icon-plusthick",this.description="Creates a new sibling node"},mindmaps.CreateSiblingNodeCommand.prototype=new mindmaps.Command,mindmaps.DeleteNodeCommand=function(){this.id="DELETE_NODE_COMMAND",this.shortcut=["del","backspace"],this.label="Delete",this.icon="ui-icon-minusthick",this.description="Deletes a new node"},mindmaps.DeleteNodeCommand.prototype=new mindmaps.Command,mindmaps.EditNodeCaptionCommand=function(){this.id="EDIT_NODE_CAPTION_COMMAND",this.shortcut=["F2","return"],this.label="Edit node caption",this.description="Edits the node text"},mindmaps.EditNodeCaptionCommand.prototype=new mindmaps.Command,mindmaps.ToggleNodeFoldedCommand=function(){this.id="TOGGLE_NODE_FOLDED_COMMAND",this.shortcut="space",this.description="Show or hide the node's children"},mindmaps.ToggleNodeFoldedCommand.prototype=new mindmaps.Command,mindmaps.UndoCommand=function(){this.id="UNDO_COMMAND",this.shortcut=["ctrl+z","meta+z"],this.label="Undo",this.icon="ui-icon-arrowreturnthick-1-w",this.description="Undo"},mindmaps.UndoCommand.prototype=new mindmaps.Command,mindmaps.RedoCommand=function(){this.id="REDO_COMMAND",this.shortcut=["ctrl+y","meta+shift+z"],this.label="Redo",this.icon="ui-icon-arrowreturnthick-1-e",this.description="Redo"},mindmaps.RedoCommand.prototype=new mindmaps.Command,mindmaps.CopyNodeCommand=function(){this.id="COPY_COMMAND",this.shortcut=["ctrl+c","meta+c"],this.label="Copy",this.icon="ui-icon-copy",this.description="Copy a branch"},mindmaps.CopyNodeCommand.prototype=new mindmaps.Command,mindmaps.CutNodeCommand=function(){this.id="CUT_COMMAND",this.shortcut=["ctrl+x","meta+x"],this.label="Cut",this.icon="ui-icon-scissors",this.description="Cut a branch"},mindmaps.CutNodeCommand.prototype=new mindmaps.Command,mindmaps.PasteNodeCommand=function(){this.id="PASTE_COMMAND",this.shortcut=["ctrl+v","meta+v"],this.label="Paste",this.icon="ui-icon-clipboard",this.description="Paste a branch"},mindmaps.PasteNodeCommand.prototype=new mindmaps.Command,mindmaps.NewDocumentCommand=function(){this.id="NEW_DOCUMENT_COMMAND",this.label="New",this.icon="ui-icon-document-b",this.description="Start working on a new mind map"},mindmaps.NewDocumentCommand.prototype=new mindmaps.Command,mindmaps.OpenDocumentCommand=function(){this.id="OPEN_DOCUMENT_COMMAND",this.label="Open...",this.shortcut=["ctrl+o","meta+o"],this.icon="ui-icon-folder-open",this.description="Open an existing mind map"},mindmaps.OpenDocumentCommand.prototype=new mindmaps.Command,mindmaps.SaveDocumentCommand=function(){this.id="SAVE_DOCUMENT_COMMAND",this.label="Save...",this.shortcut=["ctrl+s","meta+s"],this.icon="ui-icon-disk",this.description="Save the mind map"},mindmaps.SaveDocumentCommand.prototype=new mindmaps.Command,mindmaps.CloseDocumentCommand=function(){this.id="CLOSE_DOCUMENT_COMMAND",this.label="Close",this.icon="ui-icon-close",this.description="Close the mind map"},mindmaps.CloseDocumentCommand.prototype=new mindmaps.Command,mindmaps.HelpCommand=function(){this.id="HELP_COMMAND",this.enabled=!0,this.icon="ui-icon-help",this.label="Help",this.shortcut="F1",this.description="Get help!"},mindmaps.HelpCommand.prototype=new mindmaps.Command,mindmaps.PrintCommand=function(){this.id="PRINT_COMMAND",this.icon="ui-icon-print",this.label="Print",this.shortcut=["ctrl+p","meta+p"],this.description="Print the mind map"},mindmaps.PrintCommand.prototype=new mindmaps.Command,mindmaps.ExportCommand=function(){this.id="EXPORT_COMMAND",this.icon="ui-icon-image",this.label="Export As Image...",this.description="Export the mind map"},mindmaps.ExportCommand.prototype=new mindmaps.Command;
mindmaps.CommandRegistry=function(a){function b(b){b.shortcut&&b.execute&&a.register(b.shortcut,b.execute.bind(b))}function c(b){b.shortcut&&a.unregister(b.shortcut)}this.commands={},this.get=function(c){var d=this.commands[c];return d||(d=new c,this.commands[c]=d,a&&b(d)),d},this.remove=function(b){var d=this.commands[b];if(!d)return;delete this.commands[b],a&&c(d)}};
mindmaps.action={},mindmaps.action.Action=function(){},mindmaps.action.Action.prototype={noUndo:function(){return delete this.undo,delete this.redo,this},noEvent:function(){return delete this.event,this},execute:function(){},cancel:function(){this.cancelled=!0}},mindmaps.action.MoveNodeAction=function(a,b){var c=a.offset;this.execute=function(){a.offset=b},this.event=[mindmaps.Event.NODE_MOVED,a],this.undo=function(){return new mindmaps.action.MoveNodeAction(a,c)}},mindmaps.action.MoveNodeAction.prototype=new mindmaps.action.Action,mindmaps.action.DeleteNodeAction=function(a,b){var c=a.getParent();this.execute=function(){if(a.isRoot())return!1;b.removeNode(a)},this.event=[mindmaps.Event.NODE_DELETED,a,c],this.undo=function(){return new mindmaps.action.CreateNodeAction(a,c,b)}},mindmaps.action.DeleteNodeAction.prototype=new mindmaps.action.Action,mindmaps.action.CreateAutoPositionedNodeAction=function(a,b){if(a.isRoot())var c=mindmaps.Util.randomColor(),d=Math.random()>.49?1:-1,e=Math.random()>.49?1:-1,f=d*(100+Math.random()*250),g=e*Math.random()*250;else{var c=a.branchColor,d=a.offset.x>0?1:-1,f=d*(150+Math.random()*10);if(a.isLeaf())var h=5,i=-5;else var h=150,i=-150;var g=Math.floor(Math.random()*(h-i+1)+i)}var j=new mindmaps.Node;return j.branchColor=c,j.shouldEditCaption=!0,j.offset=new mindmaps.Point(f,g),new mindmaps.action.CreateNodeAction(j,a,b)},mindmaps.action.CreateNodeAction=function(a,b,c){this.execute=function(){c.addNode(a),b.addChild(a)},this.event=[mindmaps.Event.NODE_CREATED,a],this.undo=function(){return new mindmaps.action.DeleteNodeAction(a,c)}},mindmaps.action.CreateNodeAction.prototype=new mindmaps.action.Action,mindmaps.action.ToggleNodeFoldAction=function(a){return a.foldChildren?new mindmaps.action.OpenNodeAction(a):new mindmaps.action.CloseNodeAction(a)},mindmaps.action.OpenNodeAction=function(a){this.execute=function(){a.foldChildren=!1},this.event=[mindmaps.Event.NODE_OPENED,a]},mindmaps.action.OpenNodeAction.prototype=new mindmaps.action.Action,mindmaps.action.CloseNodeAction=function(a){this.execute=function(){a.foldChildren=!0},this.event=[mindmaps.Event.NODE_CLOSED,a]},mindmaps.action.CloseNodeAction.prototype=new mindmaps.action.Action,mindmaps.action.ChangeNodeCaptionAction=function(a,b){var c=a.getCaption();this.execute=function(){if(c===b)return!1;a.setCaption(b)},this.event=[mindmaps.Event.NODE_TEXT_CAPTION_CHANGED,a],this.undo=function(){return new mindmaps.action.ChangeNodeCaptionAction(a,c)}},mindmaps.action.ChangeNodeCaptionAction.prototype=new mindmaps.action.Action,mindmaps.action.ChangeNodeFontSizeAction=function(a,b){this.execute=function(){a.text.font.size+=b},this.event=[mindmaps.Event.NODE_FONT_CHANGED,a],this.undo=function(){return new mindmaps.action.ChangeNodeFontSizeAction(a,-b)}},mindmaps.action.ChangeNodeFontSizeAction.prototype=new mindmaps.action.Action,mindmaps.action.DecreaseNodeFontSizeAction=function(a){return new mindmaps.action.ChangeNodeFontSizeAction(a,-4)},mindmaps.action.IncreaseNodeFontSizeAction=function(a){return new mindmaps.action.ChangeNodeFontSizeAction(a,4)},mindmaps.action.SetFontWeightAction=function(a,b){this.execute=function(){var c=b?"bold":"normal";a.text.font.weight=c},this.event=[mindmaps.Event.NODE_FONT_CHANGED,a],this.undo=function(){return new mindmaps.action.SetFontWeightAction(a,!b)}},mindmaps.action.SetFontWeightAction.prototype=new mindmaps.action.Action,mindmaps.action.SetFontStyleAction=function(a,b){this.execute=function(){var c=b?"italic":"normal";a.text.font.style=c},this.event=[mindmaps.Event.NODE_FONT_CHANGED,a],this.undo=function(){return new mindmaps.action.SetFontStyleAction(a,!b)}},mindmaps.action.SetFontStyleAction.prototype=new mindmaps.action.Action,mindmaps.action.SetFontDecorationAction=function(a,b){var c=a.text.font.decoration;this.execute=function(){a.text.font.decoration=b},this.event=[mindmaps.Event.NODE_FONT_CHANGED,a],this.undo=function(){return new mindmaps.action.SetFontDecorationAction(a,c)}},mindmaps.action.SetFontDecorationAction.prototype=new mindmaps.action.Action,mindmaps.action.SetFontColorAction=function(a,b){var c=a.text.font.color;this.execute=function(){a.text.font.color=b},this.event=[mindmaps.Event.NODE_FONT_CHANGED,a],this.undo=function(){return new mindmaps.action.SetFontColorAction(a,c)}},mindmaps.action.SetFontColorAction.prototype=new mindmaps.action.Action,mindmaps.action.SetBranchColorAction=function(a,b){var c=a.branchColor;this.execute=function(){if(b===a.branchColor)return!1;a.branchColor=b},this.event=[mindmaps.Event.NODE_BRANCH_COLOR_CHANGED,a],this.undo=function(){return new mindmaps.action.SetBranchColorAction(a,c)}},mindmaps.action.SetBranchColorAction.prototype=new mindmaps.action.Action,mindmaps.action.CompositeAction=function(){this.actions=[]},mindmaps.action.CompositeAction.prototype.addAction=function(a){this.actions.push(a)},mindmaps.action.CompositeAction.prototype.forEachAction=function(a){this.actions.forEach(a)},mindmaps.action.SetChildrenBranchColorAction=function(a){mindmaps.action.CompositeAction.call(this);var b=a.branchColor,c=this;a.forEachDescendant(function(a){c.addAction(new mindmaps.action.SetBranchColorAction(a,b))})},mindmaps.action.SetChildrenBranchColorAction.prototype=new mindmaps.action.CompositeAction;
function timeit(a,b){var c=(new Date).getTime();a();var d=(new Date).getTime(),e=d-c;console.log(b||"",e,"ms")}function getBinaryMapWithDepth(a){function d(a,c){if(c===0)return;var e=b.createNode();e.text.caption="Node "+e.id,a.addChild(e),d(e,c-1);var f=b.createNode();f.text.caption="Node "+f.id,a.addChild(f),d(f,c-1)}function g(a,b,c){a.offset=new mindmaps.Point((b+1)*50,c);if(a.isLeaf())return;var d=a.children.values(),e=d[0];g(e,b+1,c-c/2);var f=d[1];g(f,b+1,c+c/2)}var b=new mindmaps.MindMap,c=b.root,a=a||10;d(c,a),c.offset=new mindmaps.Point(400,400);var e=80,f=c.children.values();return g(f[0],0,-e),g(f[1],0,e),f[0].branchColor=mindmaps.Util.randomColor(),f[0].forEachDescendant(function(a){a.branchColor=mindmaps.Util.randomColor()}),f[1].branchColor=mindmaps.Util.randomColor(),f[1].forEachDescendant(function(a){a.branchColor=mindmaps.Util.randomColor()}),b}function getDefaultTestMap(){var a=new mindmaps.MindMap,b=a.root,c=a.createNode(),d=a.createNode(),e=a.createNode();b.addChild(c),b.addChild(d),b.addChild(e);var f=a.createNode(),g=a.createNode();d.addChild(f),d.addChild(g);var h=a.createNode(),i=a.createNode(),j=a.createNode(),k=a.createNode();e.addChild(h),e.addChild(i),e.addChild(j),e.addChild(k);var l=a.createNode();f.addChild(l);var m=a.createNode();return l.addChild(m),a}function getDefaultTestDocument(){var a=new mindmaps.Document;return a.title="test document",a.mindmap=getDefaultTestMap(),a}function getSimpleMap(){var a=new mindmaps.MindMap,b=a.root,c=a.createNode(),d=a.createNode();return b.addChild(c),b.addChild(d),a}mindmaps.Util=mindmaps.Util||{},mindmaps.Util.trackEvent=function(a,b,c){if(!window._gaq)return;c?_gaq.push(["_trackEvent",a,b,c]):_gaq.push(["_trackEvent",a,b])},mindmaps.Util.createUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0,c=a=="x"?b:b&3|8;return c.toString(16)})},mindmaps.Util.getId=function(){return mindmaps.Util.createUUID()},mindmaps.Util.randomColor=function(){return function(a){return"#000000".substr(0,7-a.length)+a}((~~(Math.random()*(1<<24))).toString(16))},mindmaps.Util.getUrlParams=function(){var a={},b,c=/\+/g,d=/([^&=]+)=?([^&]*)/g,e=function(a){return decodeURIComponent(a.replace(c," "))},f=window.location.search.substring(1);while(b=d.exec(f))a[e(b[1])]=e(b[2]);return a},mindmaps.Util.distance=function(a,b){return Math.sqrt(a*a+b*b)};
mindmaps.Point=function(a,b){this.x=a||0,this.y=b||0},mindmaps.Point.fromObject=function(a){return new mindmaps.Point(a.x,a.y)},mindmaps.Point.prototype.clone=function(){return new mindmaps.Point(this.x,this.y)},mindmaps.Point.prototype.add=function(a){this.x+=a.x,this.y+=a.y},mindmaps.Point.prototype.toString=function(){return"{x: "+this.x+" y: "+this.y+"}"};
mindmaps.Document=function(){this.id=mindmaps.Util.createUUID(),this.title="New Document",this.mindmap=new mindmaps.MindMap,this.dates={created:new Date,modified:null},this.dimensions=new mindmaps.Point(4e3,2e3),this.autosave=!1},mindmaps.Document.fromJSON=function(a){return mindmaps.Document.fromObject(JSON.parse(a))},mindmaps.Document.fromObject=function(a){var b=new mindmaps.Document;return b.id=a.id,b.title=a.title,b.mindmap=mindmaps.MindMap.fromObject(a.mindmap),b.dates={created:new Date(a.dates.created),modified:a.dates.modified?new Date(a.dates.modified):null},b.dimensions=mindmaps.Point.fromObject(a.dimensions),b.autosave=a.autosave,b},mindmaps.Document.prototype.toJSON=function(){var a={created:this.dates.created.getTime()};return this.dates.modified&&(a.modified=this.dates.modified.getTime()),{id:this.id,title:this.title,mindmap:this.mindmap,dates:a,dimensions:this.dimensions,autosave:this.autosave}},mindmaps.Document.prototype.serialize=function(){return JSON.stringify(this)},mindmaps.Document.prototype.prepareSave=function(){return this.dates.modified=new Date,this.title=this.mindmap.getRoot().getCaption(),this},mindmaps.Document.sortByModifiedDateDescending=function(a,b){return a.dates.modified>b.dates.modified?-1:a.dates.modified<b.dates.modified?1:0},mindmaps.Document.prototype.isNew=function(){return this.dates.modified===null},mindmaps.Document.prototype.getCreatedDate=function(){return this.dates.created},mindmaps.Document.prototype.getWidth=function(){return this.dimensions.x},mindmaps.Document.prototype.getHeight=function(){return this.dimensions.y},mindmaps.Document.prototype.isAutoSave=function(){return this.autosave},mindmaps.Document.prototype.setAutoSave=function(a){this.autosave=a};
mindmaps.MindMap=function(a){this.nodes=new mindmaps.NodeMap,a?this.root=a:(this.root=new mindmaps.Node,this.root.text.font.size=20,this.root.text.font.weight="bold",this.root.text.caption="Central Idea"),this.addNode(this.root)},mindmaps.MindMap.fromJSON=function(a){return mindmaps.MindMap.fromObject(JSON.parse(a))},mindmaps.MindMap.fromObject=function(a){var b=mindmaps.Node.fromObject(a.root),c=new mindmaps.MindMap(b);return b.forEachDescendant(function(a){c.addNode(a)}),c},mindmaps.MindMap.prototype.toJSON=function(){var a={root:this.root};return a},mindmaps.MindMap.prototype.serialize=function(){return JSON.stringify(this)},mindmaps.MindMap.prototype.createNode=function(){var a=new mindmaps.Node;return this.addNode(a),a},mindmaps.MindMap.prototype.addNode=function(a){this.nodes.add(a);var b=this;a.forEachDescendant(function(a){b.nodes.add(a)})},mindmaps.MindMap.prototype.removeNode=function(a){var b=a.parent;b.removeChild(a);var c=this;a.forEachDescendant(function(a){c.nodes.remove(a)}),this.nodes.remove(a)},mindmaps.MindMap.prototype.getRoot=function(){return this.root};
mindmaps.Node=function(){this.id=mindmaps.Util.getId(),this.parent=null,this.children=new mindmaps.NodeMap,this.text={caption:"New Idea",font:{style:"normal",weight:"normal",decoration:"none",size:15,color:"#000000"}},this.offset=new mindmaps.Point,this.foldChildren=!1,this.branchColor="#000000"},mindmaps.Node.prototype.clone=function(){var a=new mindmaps.Node,b={caption:this.text.caption},c={weight:this.text.font.weight,style:this.text.font.style,decoration:this.text.font.decoration,size:this.text.font.size,color:this.text.font.color};return b.font=c,a.text=b,a.offset=this.offset.clone(),a.foldChildren=this.foldChildren,a.branchColor=this.branchColor,this.forEachChild(function(b){var c=b.clone();a.addChild(c)}),a},mindmaps.Node.fromJSON=function(a){return mindmaps.Node.fromObject(JSON.parse(a))},mindmaps.Node.fromObject=function(a){var b=new mindmaps.Node;return b.id=a.id,b.text=a.text,b.offset=mindmaps.Point.fromObject(a.offset),b.foldChildren=a.foldChildren,b.branchColor=a.branchColor,a.children.forEach(function(a){var c=mindmaps.Node.fromObject(a);b.addChild(c)}),b},mindmaps.Node.prototype.toJSON=function(){var a=this,b=function(){var b=[];return a.forEachChild(function(a){b.push(a.toJSON())}),b}(),c={id:this.id,parentId:this.parent?this.parent.id:null,text:this.text,offset:this.offset,foldChildren:this.foldChildren,branchColor:this.branchColor,children:b};return c},mindmaps.Node.prototype.serialize=function(){return JSON.stringify(this)},mindmaps.Node.prototype.addChild=function(a){a.parent=this,this.children.add(a)},mindmaps.Node.prototype.removeChild=function(a){a.parent=null,this.children.remove(a)},mindmaps.Node.prototype.isRoot=function(){return this.parent===null},mindmaps.Node.prototype.isLeaf=function(){return this.children.size()===0},mindmaps.Node.prototype.getParent=function(){return this.parent},mindmaps.Node.prototype.getRoot=function(){var a=this;while(a.parent)a=a.parent;return a},mindmaps.Node.prototype.getPosition=function(){var a=this.offset.clone(),b=this.parent;while(b)a.add(b.offset),b=b.parent;return a},mindmaps.Node.prototype.getDepth=function(){var a=this.parent,b=0;while(a)b++,a=a.parent;return b},mindmaps.Node.prototype.getChildren=function(a){var b=[];return this.children.each(function(c){if(a){var d=c.getChildren(!0);d.forEach(function(a){b.push(a)})}b.push(c)}),b},mindmaps.Node.prototype.forEachChild=function(a){this.children.each(a)},mindmaps.Node.prototype.forEachDescendant=function(a){this.children.each(function(b){a(b),b.forEachDescendant(a)})},mindmaps.Node.prototype.setCaption=function(a){this.text.caption=a},mindmaps.Node.prototype.getCaption=function(){return this.text.caption},mindmaps.Node.prototype.isDescendant=function(a){function b(c){var d=c.children.values();for(var e=0,f=d.length;e<f;e++){var g=d[e];if(b(g))return!0;if(g===a)return!0}return!1}return b(this)};
mindmaps.NodeMap=function(){this.nodes={},this.count=0},mindmaps.NodeMap.prototype.get=function(a){return this.nodes[a]},mindmaps.NodeMap.prototype.add=function(a){return this.nodes.hasOwnProperty(a.id)?!1:(this.nodes[a.id]=a,this.count++,!0)},mindmaps.NodeMap.prototype.remove=function(a){return this.nodes.hasOwnProperty(a.id)?(delete this.nodes[a.id],this.count--,!0):!1},mindmaps.NodeMap.prototype.size=function(){return this.count},mindmaps.NodeMap.prototype.values=function(){return Object.keys(this.nodes).map(function(a){return this.nodes[a]},this)},mindmaps.NodeMap.prototype.each=function(a){for(var b in this.nodes)a(this.nodes[b])};
function UndoManager(a){this.maxStackSize=a||64;var b={UNDO:"undo",REDO:"redo"},c=this,d=new UndoManager.CircularStack(this.maxStackSize),e=new UndoManager.CircularStack(this.maxStackSize),f=!1,g=null,h=null,i=function(){c.stateChanged&&c.stateChanged()},j=function(a){g=a,f=!0;switch(h){case b.UNDO:a.undo();break;case b.REDO:a.redo()}f=!1};this.addUndo=function(a,c){if(f)g.redo==null&&h==b.UNDO&&(g.redo=a);else{var j={undo:a,redo:c};d.push(j),e.clear(),i()}},this.undo=function(){if(this.canUndo()){h=b.UNDO;var a=d.pop();j(a),a.redo&&e.push(a),i()}},this.redo=function(){if(this.canRedo()){h=b.REDO;var a=e.pop();j(a),a.undo&&d.push(a),i()}},this.canUndo=function(){return!d.isEmpty()},this.canRedo=function(){return!e.isEmpty()},this.reset=function(){d.clear(),e.clear(),f=!1,g=null,h=null,i()},this.stateChanged=function(){}}UndoManager.CircularStack=function(a){this.maxSize=a||32,this.buffer=[],this.nextPointer=0},UndoManager.CircularStack.prototype.push=function(a){this.buffer[this.nextPointer]=a,this.nextPointer=(this.nextPointer+1)%this.maxSize},UndoManager.CircularStack.prototype.isEmpty=function(){if(this.buffer.length===0)return!0;var a=this.getPreviousPointer();return a===null?!0:this.buffer[a]===null},UndoManager.CircularStack.prototype.getPreviousPointer=function(){return this.nextPointer>0?this.nextPointer-1:this.buffer.length<this.maxSize?null:this.maxSize-1},UndoManager.CircularStack.prototype.clear=function(){this.buffer.length=0,this.nextPointer=0},UndoManager.CircularStack.prototype.pop=function(){if(this.isEmpty())return null;var a=this.getPreviousPointer(),b=this.buffer[a];return this.buffer[a]=null,this.nextPointer=a,b},UndoManager.CircularStack.prototype.peek=function(){return this.isEmpty()?null:this.buffer[this.getPreviousPointer()]};
mindmaps.UndoController=function(a,b){this.init=function(){this.undoManager=new UndoManager(128),this.undoManager.stateChanged=this.undoStateChanged.bind(this),this.undoCommand=b.get(mindmaps.UndoCommand),this.undoCommand.setHandler(this.doUndo.bind(this)),this.redoCommand=b.get(mindmaps.RedoCommand),this.redoCommand.setHandler(this.doRedo.bind(this)),a.subscribe(mindmaps.Event.DOCUMENT_OPENED,this.documentOpened.bind(this)),a.subscribe(mindmaps.Event.DOCUMENT_CLOSED,this.documentClosed.bind(this))},this.undoStateChanged=function(){this.undoCommand.setEnabled(this.undoManager.canUndo()),this.redoCommand.setEnabled(this.undoManager.canRedo())},this.addUndo=function(a,b){this.undoManager.addUndo(a,b)},this.doUndo=function(){this.undoManager.undo()},this.doRedo=function(){this.undoManager.redo()},this.documentOpened=function(){this.undoManager.reset(),this.undoStateChanged()},this.documentClosed=function(){this.undoManager.reset(),this.undoStateChanged()},this.init()};
mindmaps.ClipboardController=function(a,b,c){function h(){e=b.get(mindmaps.CopyNodeCommand),e.setHandler(j),f=b.get(mindmaps.CutNodeCommand),f.setHandler(k),g=b.get(mindmaps.PasteNodeCommand),g.setHandler(l),g.setEnabled(!1),a.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(){e.setEnabled(!1),f.setEnabled(!1),g.setEnabled(!1)}),a.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(){e.setEnabled(!0),f.setEnabled(!0),g.setEnabled(d!=null)})}function i(){d=c.selectedNode.clone(),g.setEnabled(!0)}function j(){i()}function k(){i(),c.deleteNode(c.selectedNode)}function l(){if(!d)return;c.createNode(d.clone(),c.selectedNode)}var d,e,f,g;h()};
mindmaps.ZoomController=function(a,b){var c=this;this.ZOOM_STEP=.25,this.MAX_ZOOM=3,this.MIN_ZOOM=.25,this.DEFAULT_ZOOM=1,this.zoomFactor=this.DEFAULT_ZOOM,this.zoomTo=function(b){b<=this.MAX_ZOOM&&b>=this.MIN_ZOOM&&(this.zoomFactor=b,a.publish(mindmaps.Event.ZOOM_CHANGED,b))},this.zoomIn=function(){return this.zoomFactor+=this.ZOOM_STEP,this.zoomFactor>this.MAX_ZOOM?this.zoomFactor-=this.ZOOM_STEP:a.publish(mindmaps.Event.ZOOM_CHANGED,this.zoomFactor),this.zoomFactor},this.zoomOut=function(){return this.zoomFactor-=this.ZOOM_STEP,this.zoomFactor<this.MIN_ZOOM?this.zoomFactor+=this.ZOOM_STEP:a.publish(mindmaps.Event.ZOOM_CHANGED,this.zoomFactor),this.zoomFactor},a.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(a){c.zoomTo(c.DEFAULT_ZOOM)})};
mindmaps.ShortcutController=function(){function a(a,b){return b=b||"keydown",b+"."+a}this.shortcuts={},this.register=function(b,c,d){Array.isArray(b)||(b=[b]);var e=this;b.forEach(function(b){d=a(b,d),$(document).bind(d,b,function(a){return a.stopImmediatePropagation(),a.stopPropagation(),a.preventDefault(),c(),!1})})},this.unregister=function(b,c){c=a(b,c),$(document).unbind(c),delete this.shortcuts[c]},this.unregisterAll=function(){for(var a in shortcuts)$(document).unbind(a)}};
mindmaps.HelpController=function(a,b){function c(){function d(){b.forEach(function(a){a.close()})}function g(){e=new mindmaps.Notification("#toolbar",{position:"bottomMiddle",maxWidth:550,title:"Welcome to mindmaps",content:"Hello there, it seems like you are new here! These bubbles will guide you through the app. Or they won't if you want to skip this tutorial and <a class='skip-tutorial link'>click here<a/>."}),b.push(e),e.$().find("a.skip-tutorial").click(function(){c=!1,d(),p()}),setTimeout(h,2e3)}function h(){if(o())return;f=new mindmaps.Notification(".node-caption.root",{position:"bottomMiddle",closeButton:!0,maxWidth:350,title:"This is where you start - your main idea",content:"Double click the idea to change what it says. This will be the main topic of your mind map."}),b.push(f),a.once(mindmaps.Event.NODE_TEXT_CAPTION_CHANGED,function(){f.close(),setTimeout(i,900)})}function i(){if(o())return;var c=new mindmaps.Notification(".node-caption.root",{position:"bottomMiddle",closeButton:!0,maxWidth:350,padding:20,title:"Creating new ideas",content:"Now it's time to build your mind map.<br/> Move your mouse over the idea, click and then drag the <span style='color:red'>red circle</span> away from the root. This is how you create a new branch."});b.push(c),a.once(mindmaps.Event.NODE_CREATED,function(){e.close(),c.close(),setTimeout(j,900)})}function j(){if(o())return;var c=new mindmaps.Notification(".node-container.root > .node-container:first",{position:"bottomMiddle",closeButton:!0,maxWidth:350,title:"Your first branch",content:"Great! This is easy, right? The red circle is your most important tool. Now, you can move your idea around by dragging it or double click to change the text again."});b.push(c),setTimeout(l,2e3),a.once(mindmaps.Event.NODE_MOVED,function(){c.close(),setTimeout(k,0),setTimeout(m,15e3),setTimeout(n,1e4),setTimeout(p,2e4)})}function k(){if(o())return;var a=new mindmaps.Notification(".float-panel:has(#navigator)",{position:"bottomRight",closeButton:!0,maxWidth:350,expires:1e4,title:"Navigation",content:"You can click and drag the background of the map to move around. Use your mousewheel or slider over there to zoom in and out."});b.push(a)}function l(){if(o())return;var a=new mindmaps.Notification("#inspector",{position:"leftBottom",closeButton:!0,maxWidth:350,padding:20,title:"Don't like the colors?",content:"Use these controls to change the appearance of your ideas. Try clicking the icon in the upper right corner to minimize this panel."});b.push(a)}function m(){if(o())return;var a=new mindmaps.Notification("#toolbar .buttons-left",{position:"bottomLeft",closeButton:!0,maxWidth:350,padding:20,title:"The tool bar",content:"Those buttons do what they say. You can use them or work with keyboard shortcuts. Hover over the buttons for the key combinations."});b.push(a)}function n(){if(o())return;var a=new mindmaps.Notification("#toolbar .buttons-right",{position:"leftTop",closeButton:!0,maxWidth:350,title:"Save your work",content:"The button to the right opens a menu where you can save your mind map or start working on another one if you like."});b.push(a)}function o(){return mindmaps.LocalStorage.get("mindmaps.tutorial.done")==1}function p(){mindmaps.LocalStorage.put("mindmaps.tutorial.done",1)}if(o()){console.debug("skipping tutorial");return}var b=[],c=!0;a.once(mindmaps.Event.DOCUMENT_OPENED,function(){setTimeout(g,1e3)});var e,f}function d(){function d(){var a=c.some(function(a){return a.isVisible()});if(a){c.forEach(function(a){a.close()}),c.length=0;return}var b=new mindmaps.Notification(".node-caption.root",{position:"bottomLeft",closeButton:!0,maxWidth:350,title:"This is your main idea",content:"Double click an idea to edit its text. Move the mouse over an idea and drag the red circle to create a new idea."}),d=new mindmaps.Notification("#navigator",{position:"leftTop",closeButton:!0,maxWidth:350,padding:20,title:"This is the navigator",content:"Use this panel to get an overview of your map. You can navigate around by dragging the red rectangle or change the zoom by clicking on the magnifier buttons."}),e=new mindmaps.Notification("#inspector",{position:"leftTop",closeButton:!0,maxWidth:350,padding:20,title:"This is the inspector",content:"Use these controls to change the appearance of your ideas. Try clicking the icon in the upper right corner to minimize this panel."}),f=new mindmaps.Notification("#toolbar .buttons-left",{position:"bottomLeft",closeButton:!0,maxWidth:350,title:"This is your toolbar",content:"Those buttons do what they say. You can use them or work with keyboard shortcuts. Hover over the buttons for the key combinations."});c.push(b,d,e,f)}var a=b.get(mindmaps.HelpCommand);a.setHandler(d);var c=[]}c(),d()};
mindmaps.FloatPanelFactory=function(a){function f(f){a.subscribe(mindmaps.CanvasContainer.Event.RESIZED,function(){c.forEach(function(a){a.visible&&a.ensurePosition()})});var g=b.outerWidth(),h=b.offset().top,i=f.width(),j=f.height(),k=c.reduce(function(a,b){return a+b.height()+e},0);f.setPosition(g-i-d,h+e+k)}var b=a.getContent(),c=[],d=15,e=5;this.create=function(a,d){var e=new mindmaps.FloatPanel(a,b,d);return f(e),c.push(e),e}},mindmaps.FloatPanel=function(a,b,c){var d=this,e=!1;this.caption=a,this.visible=!1,this.animationDuration=400,this.setContent=function(a){this.clearContent(),$("div.ui-dialog-content",this.$widget).append(a)},this.clearContent=function(){$("div.ui-dialog-content",this.$widget).children().detach()},this.$widget=function(){var e=$("#template-float-panel").tmpl({title:a});return e.find(".ui-dialog-titlebar-close").click(function(){d.hide()}),c&&e.find(".ui-dialog-content").append(c),e.draggable({containment:"parent",handle:"div.ui-dialog-titlebar",opacity:.75}).hide().appendTo(b),e}(),this.hide=function(){!e&&this.visible&&(this.visible=!1,this.$widget.fadeOut(this.animationDuration*1.5),this.$hideTarget&&this.transfer(this.$widget,this.$hideTarget))},this.show=function(){!e&&!this.visible&&(this.visible=!0,this.$widget.fadeIn(this.animationDuration*1.5),this.ensurePosition(),this.$hideTarget&&this.transfer(this.$hideTarget,this.$widget))},this.toggle=function(){this.visible?this.hide():this.show()},this.transfer=function(a,b){e=!0;var c=b.offset(),d={top:c.top,left:c.left,height:b.innerHeight(),width:b.innerWidth()},f=a.offset(),g=$('<div class="ui-effects-transfer"></div>').appendTo(document.body).css({top:f.top,left:f.left,height:a.innerHeight(),width:a.innerWidth(),position:"absolute"}).animate(d,this.animationDuration,"linear",function(){g.remove(),e=!1})},this.width=function(){return this.$widget.outerWidth()},this.height=function(){return this.$widget.outerHeight()},this.offset=function(){return this.$widget.offset()},this.setPosition=function(a,b){this.$widget.offset({left:a,top:b})},this.ensurePosition=function(){var a=b.outerWidth(),c=b.outerHeight(),d=b.offset().left,e=b.offset().top,f=this.width(),g=this.height(),h=this.offset().left,i=this.offset().top;a+d<f+h&&a>=f&&this.setPosition(a+d-f,i),c+e<g+i&&c>=g&&this.setPosition(h,c+e-g)},this.setHideTarget=function(a){this.$hideTarget=a}};
mindmaps.NavigatorView=function(){var a=this,b=$("#template-navigator").tmpl(),c=b.children(".active").hide(),d=b.children(".inactive").hide(),e=$("#navi-canvas-overlay",b),f=$("#navi-canvas",b);this.getContent=function(){return b},this.showActiveContent=function(){d.hide(),c.show()},this.showInactiveContent=function(){c.hide(),d.show()},this.setDraggerSize=function(a,b){e.css({width:a,height:b})},this.setDraggerPosition=function(a,b){e.css({left:a,top:b})},this.setCanvasHeight=function(a){$("#navi-canvas",b).css({height:a})},this.getCanvasWidth=function(){return $("#navi-canvas",b).width()},this.init=function(c){$("#navi-slider",b).slider({min:0,max:11,step:1,value:3,slide:function(b,c){a.sliderChanged&&a.sliderChanged(c.value)}}),$("#button-navi-zoom-in",b).button({text:!1,icons:{primary:"ui-icon-zoomin"}}).click(function(){a.buttonZoomInClicked&&a.buttonZoomInClicked()}),$("#button-navi-zoom-out",b).button({text:!1,icons:{primary:"ui-icon-zoomout"}}).click(function(){a.buttonZoomOutClicked&&a.buttonZoomOutClicked()}),e.draggable({containment:"parent",start:function(b,c){a.dragStart&&a.dragStart()},drag:function(b,c){if(a.dragging){var d=c.position.left,e=c.position.top;a.dragging(d,e)}},stop:function(b,c){a.dragStop&&a.dragStop()}})},this.draw=function(a,b){function i(a){return a/b}function j(a,b,c){h.save(),h.translate(b,c),a.collapseChildren||a.forEachChild(function(a){h.beginPath(),h.strokeStyle=a.branchColor,h.moveTo(0,0);var b=i(a.offset.x),c=i(a.offset.y),d=5;if(b<0)var e=b+d,f=b;else var e=b,f=b+d;h.lineTo(e,c),h.lineTo(f,c),h.stroke(),j(a,f,c)}),h.restore()}var c=a.root,d=f[0],e=d.width,g=d.height,h=d.getContext("2d");h.clearRect(0,0,e,g),h.lineWidth=1.8,j(c,e/2,g/2),h.fillRect(e/2-4,g/2-2,8,4)},this.showZoomLevel=function(a){$("#navi-zoom-level").text(a)},this.setSliderValue=function(a){$("#navi-slider").slider("value",a)}},mindmaps.NavigatorPresenter=function(a,b,c,d){function l(){var a=f.width()/h,c=f.height()/h,d=a*i.x/j.x,e=c*i.y/j.y;d>i.x&&(d=i.x),e>i.y&&(e=i.y),b.setDraggerSize(d,e)}function m(){var a=b.getCanvasWidth(),c=j.x/a,d=j.y/c;b.setCanvasHeight(d),i.x=a,i.y=d}function n(){var a=f.scrollLeft()/h,c=f.scrollTop()/h,d=a*i.x/j.x,e=c*i.y/j.y;b.setDraggerPosition(d,e)}function o(){var a=h*100+" %";b.showZoomLevel(a)}function p(){var a=h/d.ZOOM_STEP-1;b.setSliderValue(a)}function q(a){j=a.dimensions,k=a.mindmap,m(),n(),l(),o(),p(),r(),b.showActiveContent(),f.bind("scroll.navigator-view",function(){g||n()})}function r(){var a=j.x/i.x;b.draw(k,a)}function s(){j=null,k=null,h=1,f.unbind("scroll.navigator-view"),b.showInactiveContent()}var e=this,f=c.getContent(),g=!1,h=d.DEFAULT_ZOOM,i=new mindmaps.Point,j=null,k=null;b.dragStart=function(){g=!0},b.dragging=function(a,b){var c=h*j.x*a/i.x,d=h*j.y*b/i.y;f.scrollLeft(c).scrollTop(d)},b.dragStop=function(){g=!1},b.buttonZoomInClicked=function(){d.zoomIn()},b.buttonZoomOutClicked=function(){d.zoomOut()},b.sliderChanged=function(a){d.zoomTo((a+1)*d.ZOOM_STEP)},c.subscribe(mindmaps.CanvasContainer.Event.RESIZED,function(){j&&l()}),a.subscribe(mindmaps.Event.DOCUMENT_OPENED,q),a.subscribe(mindmaps.Event.DOCUMENT_CLOSED,s),a.subscribe(mindmaps.Event.NODE_MOVED,r),a.subscribe(mindmaps.Event.NODE_BRANCH_COLOR_CHANGED,r),a.subscribe(mindmaps.Event.NODE_CREATED,r),a.subscribe(mindmaps.Event.NODE_DELETED,r),a.subscribe(mindmaps.Event.NODE_OPENED,r),a.subscribe(mindmaps.Event.NODE_CLOSED,r),a.subscribe(mindmaps.Event.ZOOM_CHANGED,function(a){h=a,n(),l(),o(),p()}),this.go=function(){b.init(),b.showInactiveContent()}};
mindmaps.InspectorView=function(){var a=this,b=$("#template-inspector").tmpl(),c=$("#inspector-button-font-size-decrease",b),d=$("#inspector-button-font-size-increase",b),e=$("#inspector-checkbox-font-bold",b),f=$("#inspector-checkbox-font-italic",b),g=$("#inspector-checkbox-font-underline",b),h=$("#inspector-checkbox-font-linethrough",b),i=$("#inspector-button-branch-color-children",b),j=$("#inspector-branch-color-picker",b),k=$("#inspector-font-color-picker",b),l=[c,d,e,f,g,h,i],m=[j,k];this.getContent=function(){return b},this.setControlsEnabled=function(a){var b=a?"enable":"disable";l.forEach(function(a){a.button(b)}),m.forEach(function(b){b.miniColors("disabled",!a)})},this.setBoldCheckboxState=function(a){e.prop("checked",a).button("refresh")},this.setItalicCheckboxState=function(a){f.prop("checked",a).button("refresh")},this.setUnderlineCheckboxState=function(a){g.prop("checked",a).button("refresh")},this.setLinethroughCheckboxState=function(a){h.prop("checked",a).button("refresh")},this.setBranchColorPickerColor=function(a){j.miniColors("value",a)},this.setFontColorPickerColor=function(a){k.miniColors("value",a)},this.init=function(){$(".buttonset",b).buttonset(),i.button(),c.click(function(){a.fontSizeDecreaseButtonClicked&&a.fontSizeDecreaseButtonClicked()}),d.click(function(){a.fontSizeIncreaseButtonClicked&&a.fontSizeIncreaseButtonClicked()}),e.click(function(){if(a.fontBoldCheckboxClicked){var b=$(this).prop("checked");a.fontBoldCheckboxClicked(b)}}),f.click(function(){if(a.fontItalicCheckboxClicked){var b=$(this).prop("checked");a.fontItalicCheckboxClicked(b)}}),g.click(function(){if(a.fontUnderlineCheckboxClicked){var b=$(this).prop("checked");a.fontUnderlineCheckboxClicked(b)}}),h.click(function(){if(a.fontLinethroughCheckboxClicked){var b=$(this).prop("checked");a.fontLinethroughCheckboxClicked(b)}}),j.miniColors({hide:function(b){if(this.attr("disabled"))return;console.log("hide branch",b),a.branchColorPicked&&a.branchColorPicked(b)},move:function(b){a.branchColorPreview&&a.branchColorPreview(b)}}),k.miniColors({hide:function(b){if(this.attr("disabled"))return;console.log("font",b),a.fontColorPicked&&a.fontColorPicked(b)},move:function(b){a.fontColorPreview&&a.fontColorPreview(b)}}),i.click(function(){a.branchColorChildrenButtonClicked&&a.branchColorChildrenButtonClicked()})}},mindmaps.InspectorPresenter=function(a,b,c){function e(a){var b=a.text.font;c.setBoldCheckboxState(b.weight==="bold"),c.setItalicCheckboxState(b.style==="italic"),c.setUnderlineCheckboxState(b.decoration==="underline"),c.setLinethroughCheckboxState(b.decoration==="line-through"),c.setFontColorPickerColor(b.color),c.setBranchColorPickerColor(a.branchColor)}var d=this;c.fontSizeDecreaseButtonClicked=function(){var a=new mindmaps.action.DecreaseNodeFontSizeAction(b.selectedNode);b.executeAction(a)},c.fontSizeIncreaseButtonClicked=function(){var a=new mindmaps.action.IncreaseNodeFontSizeAction(b.selectedNode);b.executeAction(a)},c.fontBoldCheckboxClicked=function(a){var c=new mindmaps.action.SetFontWeightAction(b.selectedNode,a);b.executeAction(c)},c.fontItalicCheckboxClicked=function(a){var c=new mindmaps.action.SetFontStyleAction(b.selectedNode,a);b.executeAction(c)},c.fontUnderlineCheckboxClicked=function(a){var c=new mindmaps.action.SetFontDecorationAction(b.selectedNode,a?"underline":"none");b.executeAction(c)},c.fontLinethroughCheckboxClicked=function(a){var c=new mindmaps.action.SetFontDecorationAction(b.selectedNode,a?"line-through":"none");b.executeAction(c)},c.branchColorPicked=function(a){var c=new mindmaps.action.SetBranchColorAction(b.selectedNode,a);b.executeAction(c)},c.branchColorPreview=function(c){a.publish(mindmaps.Event.NODE_BRANCH_COLOR_PREVIEW,b.selectedNode,c)},c.fontColorPicked=function(a){var c=new mindmaps.action.SetFontColorAction(b.selectedNode,a);b.executeAction(c)},c.fontColorPreview=function(c){a.publish(mindmaps.Event.NODE_FONT_COLOR_PREVIEW,b.selectedNode,c)},c.branchColorChildrenButtonClicked=function(){var a=new mindmaps.action.SetChildrenBranchColorAction(b.selectedNode);b.executeAction(a)},a.subscribe(mindmaps.Event.NODE_FONT_CHANGED,function(a){b.selectedNode===a&&e(a)}),a.subscribe(mindmaps.Event.NODE_BRANCH_COLOR_CHANGED,function(a){b.selectedNode===a&&e(a)}),a.subscribe(mindmaps.Event.NODE_SELECTED,function(a){e(a)}),a.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(){c.setControlsEnabled(!0)}),a.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(){c.setControlsEnabled(!1)}),this.go=function(){c.init()}};
mindmaps.ToolBarView=function(){var a=this;this.init=function(){},this.addButton=function(a,b){b(a.asJquery())},this.addButtonGroup=function(a,b){var c=$("<span/>");a.forEach(function(a){c.append(a.asJquery())}),c.buttonset(),b(c)},this.addMenu=function(a){this.alignRight(a.getContent())},this.alignLeft=function(a){a.appendTo("#toolbar .buttons-left")},this.alignRight=function(a){a.appendTo("#toolbar .buttons-right")}},mindmaps.ToolBarButton=function(a){this.command=a;var b=this;a.subscribe(mindmaps.Command.Event.ENABLED_CHANGED,function(a){b.setEnabled&&b.setEnabled(a)})},mindmaps.ToolBarButton.prototype.isEnabled=function(){return this.command.enabled},mindmaps.ToolBarButton.prototype.click=function(){this.command.execute()},mindmaps.ToolBarButton.prototype.getTitle=function(){return this.command.label},mindmaps.ToolBarButton.prototype.getToolTip=function(){var a=this.command.description,b=this.command.shortcut;return b&&(Array.isArray(b)&&(b=b.join(", ")),a+=" ["+b.toUpperCase()+"]"),a},mindmaps.ToolBarButton.prototype.getId=function(){return"button-"+this.command.id},mindmaps.ToolBarButton.prototype.asJquery=function(){var a=this,b=$("<button/>",{id:this.getId(),title:this.getToolTip()}).click(function(){a.click()}).button({label:this.getTitle(),disabled:!this.isEnabled()}),c=this.command.icon;return c&&b.button({icons:{primary:c}}),this.setEnabled=function(a){b.button(a?"enable":"disable")},b},mindmaps.ToolBarMenu=function(a,b){var c=this;this.$menuWrapper=$("<span/>",{"class":"menu-wrapper"}).hover(function(){c.$menu.show()},function(){c.$menu.hide()}),this.$menuButton=$("<button/>").button({label:a,icons:{primary:b,secondary:"ui-icon-triangle-1-s"}}).appendTo(this.$menuWrapper),this.$menu=$("<div/>",{"class":"menu"}).click(function(){c.$menu.hide()}).appendTo(this.$menuWrapper),this.add=function(a){Array.isArray(a)||(a=[a]),a.forEach(function(a){var b=a.asJquery().removeClass("ui-corner-all").addClass("menu-item");this.$menu.append(b)},this),this.$menu.children().last().addClass("ui-corner-bottom").prev().removeClass("ui-corner-bottom")},this.getContent=function(){return this.$menuWrapper}},mindmaps.ToolBarPresenter=function(a,b,c,d){function e(a){var c=b.get(a);return new mindmaps.ToolBarButton(c)}function f(a){return a.map(e)}var g=[mindmaps.CreateNodeCommand,mindmaps.DeleteNodeCommand],h=f(g);c.addButtonGroup(h,c.alignLeft);var i=[mindmaps.UndoCommand,mindmaps.RedoCommand],j=f(i);c.addButtonGroup(j,c.alignLeft);var k=[mindmaps.CopyNodeCommand,mindmaps.CutNodeCommand,mindmaps.PasteNodeCommand],l=f(k);c.addButtonGroup(l,c.alignLeft);var m=new mindmaps.ToolBarMenu("Mind map","ui-icon-document"),n=[mindmaps.NewDocumentCommand,mindmaps.OpenDocumentCommand,mindmaps.SaveDocumentCommand,mindmaps.ExportCommand,mindmaps.PrintCommand,mindmaps.CloseDocumentCommand],o=f(n);m.add(o),c.addMenu(m),c.addButton(e(mindmaps.HelpCommand),c.alignRight),this.go=function(){c.init()}};
mindmaps.StatusBarView=function(){var a=this,b=$("#statusbar");this.init=function(){},this.createButton=function(c,d){return $("<button/>",{id:"statusbar-button-"+c}).button({label:d}).click(function(){a.buttonClicked&&a.buttonClicked(c)}).prependTo(b.find(".buttons"))},this.getContent=function(){return b}},mindmaps.StatusBarPresenter=function(a,b){var c=0,d={},e=new mindmaps.StatusNotificationController(a,b.getContent());b.buttonClicked=function(a){d[a].toggle()},this.go=function(){b.init()},this.addEntry=function(a){var e=c++,f=b.createButton(e,a.caption);a.setHideTarget(f),d[e]=a}},mindmaps.StatusNotificationController=function(a,b){var c=$("<div class='notification-anchor'/>").css({position:"absolute",right:20}).appendTo(b);a.subscribe(mindmaps.Event.DOCUMENT_SAVED,function(){var a=new mindmaps.Notification(c,{position:"topRight",expires:2500,content:"Mind map saved"})}),a.subscribe(mindmaps.Event.NOTIFICATION_INFO,function(a){var b=new mindmaps.Notification(c,{position:"topRight",content:a,expires:2500,type:"info"})}),a.subscribe(mindmaps.Event.NOTIFICATION_WARN,function(a){var b=new mindmaps.Notification(c,{position:"topRight",title:"Warning",content:a,expires:3e3,type:"warn"})}),a.subscribe(mindmaps.Event.NOTIFICATION_ERROR,function(a){var b=new mindmaps.Notification(c,{position:"topRight",title:"Error",content:a,expires:3500,type:"error"})})};
mindmaps.CanvasDrawingUtil={getLineWidth:function(a,b){var c=a*(12-b*2);return c<2&&(c=2),c},roundedRect:function(b,c,d,e,f,g){b.beginPath(),b.moveTo(c,d+g),b.lineTo(c,d+f-g),b.quadraticCurveTo(c,d+f,c+g,d+f),b.lineTo(c+e-g,d+f),b.quadraticCurveTo(c+e,d+f,c+e,d+f-g),b.lineTo(c+e,d+g),b.quadraticCurveTo(c+e,d,c+e-g,d),b.lineTo(c+g,d),b.quadraticCurveTo(c,d,c,d+g),b.stroke(),b.fill()}},mindmaps.CanvasBranchDrawer=function(){this.beforeDraw=function(a,b,c,d){},this.render=function(a,b,c,d,e,f,g,h){c*=h,d*=h;var i=f.width(),j=e.width(),k=f.innerHeight(),l=e.innerHeight(),m,n,o=!1,p,q,r,s,t,u=c+j/2<i/2;if(u){var v=Math.abs(c);v>j?(r=v-j+1,p=j,m=!0):(p=-c,r=j+c,m=!1,o=!0)}else c>i?(r=c-i+1,p=i-c,m=!1):(r=i-c,p=0,m=!0,o=!0);var w=mindmaps.CanvasDrawingUtil.getLineWidth(h,b),x=w/2;r<w&&(r=w);var y=d+l<k;y?(q=l,s=f.outerHeight()-d-q,n=!0):(q=k-d,s=e.outerHeight()-q,n=!1),this.beforeDraw(r,s,p,q);var z,A,B,C;m?(z=0,B=r):(z=r,B=0);var D=mindmaps.CanvasDrawingUtil.getLineWidth(h,b-1),E=(D-w)/2;n?(A=0+x,C=s-x-E):(A=s-x,C=0+x+E);if(!o)var F=z>B?z/5:B-B/5,G=C,H=Math.abs(z-B)/2,I=A;else{m?(z+=x,B-=x):(z-=x,B+=x);var H=z,I=Math.abs(A-C)/2,F=B,G=A>C?A/5:C-C/5}a.lineWidth=w,a.strokeStyle=g,a.fillStyle=g,a.beginPath(),a.moveTo(z,A),a.bezierCurveTo(H,I,F,G,B,C),a.stroke();var J=!1;J&&(a.beginPath(),a.fillStyle="red",a.arc(H,I,4,0,Math.PI*2),a.fill(),a.beginPath(),a.fillStyle="green",a.arc(F,G,4,0,Math.PI*2),a.fill())}},mindmaps.TextMetrics=function(){var a=$("<div/>",{"class":"node-text-behaviour"}).css({position:"absolute",visibility:"hidden",height:"auto",width:"auto"}).prependTo($("body"));return{ROOT_CAPTION_MIN_WIDTH:100,NODE_CAPTION_MIN_WIDTH:70,NODE_CAPTION_MAX_WIDTH:150,getTextMetrics:function(b,c,d){c=c||1,d=d||b.getCaption();var e=b.text.font,f=b.isRoot()?this.ROOT_CAPTION_MIN_WIDTH:this.NODE_CAPTION_MIN_WIDTH,g=this.NODE_CAPTION_MAX_WIDTH;a.css({"font-size":c*e.size,"min-width":c*f,"max-width":c*g,"font-weight":e.weight}).text(d);var h=a.width()+2,i=a.height()+2;return{width:h,height:i}}}}();
mindmaps.CanvasView=function(){this.$getDrawingArea=function(){return $("#drawing-area")},this.$getContainer=function(){return $("#canvas-container")},this.center=function(){var a=this.$getContainer(),b=this.$getDrawingArea(),c=b.width()-a.width(),d=b.height()-a.height();this.scroll(c/2,d/2)},this.scroll=function(a,b){var c=this.$getContainer();c.scrollLeft(a).scrollTop(b)},this.applyViewZoom=function(){var a=this.zoomFactorDelta,b=this.$getContainer(),c=b.scrollLeft(),d=b.scrollTop(),e=b.width(),f=b.height(),g=e/2+c,h=f/2+d;g*=this.zoomFactorDelta,h*=this.zoomFactorDelta,c=g-e/2,d=h-f/2;var i=this.$getDrawingArea(),j=i.width(),k=i.height();i.width(j*a).height(k*a),this.scroll(c,d);var l=parseFloat(i.css("background-size"));isNaN(l)&&console.warn("Could not set background-size!"),i.css("background-size",l*a)},this.setDimensions=function(a,b){a*=this.zoomFactor,b*=this.zoomFactor;var c=this.$getDrawingArea();c.width(a).height(b)},this.setZoomFactor=function(a){this.zoomFactorDelta=a/(this.zoomFactor||1),this.zoomFactor=a}},mindmaps.CanvasView.prototype.drawMap=function(a){throw new Error("Not implemented")},mindmaps.DefaultCanvasView=function(){function g(){a.$getContainer().dragscrollable({dragSelector:"#drawing-area, canvas.line-canvas",acceptPropagatedEvent:!1,delegateMode:!0,preventDefault:!0})}function h(a){return $("#node-canvas-"+a.id)}function i(a){return $("#node-"+a.id)}function j(a){return $("#node-caption-"+a.id)}function k(b,c,d,e,g,h,i){var j=b[0],k=j.getContext("2d");f.$canvas=b,f.render(k,c,d,e,g,h,i,a.zoomFactor)}function l(a,b){var c=a.getParent(),d=a.getDepth(),e=a.offset.x,f=a.offset.y;b=b||a.branchColor;var g=i(a),j=i(c),l=h(a);k(l,d,e,f,g,j,b)}function m(a){function f(){c&&b.commit&&b.commit(b.node,d.val())}function g(){setTimeout(function(){a.redrawNodeConnectors(b.node)},1)}var b=this,c=!1,d=$("<textarea/>",{id:"caption-editor","class":"node-text-behaviour"}).bind("keydown","esc",function(){b.stop()}).bind("keydown","return",function(){f()}).mousedown(function(a){a.stopPropagation()}).blur(function(){f()}).bind("input",function(){var c=e.getTextMetrics(b.node,a.zoomFactor,d.val());d.css(c),g()});this.edit=function(g,h){if(c)return;this.node=g,c=!0,this.$text=j(g),this.$cancelArea=h,this.text=this.$text.text(),this.$text.css({width:"auto",height:"auto"}).empty().addClass("edit"),h.bind("mousedown.editNodeCaption",function(a){f()});var i=e.getTextMetrics(b.node,a.zoomFactor,this.text);d.attr({value:this.text}).css(i).appendTo(this.$text).select()},this.stop=function(){c&&(c=!1,this.$text.removeClass("edit"),d.detach(),this.$cancelArea.unbind("mousedown.editNodeCaption"),a.setNodeText(this.node,this.text),g())}}function n(a){var b=this,c=!1;this.node=null,this.lineColor=null;var d=$("<div/>",{id:"creator-wrapper"}).bind("remove",function(a){return b.detach(),a.stopImmediatePropagation(),console.debug("creator detached."),!1}),e=$("<div/>",{id:"creator-nub"}).appendTo(d),f=$("<div/>",{id:"creator-fakenode"}).appendTo(e),g=$("<canvas/>",{id:"creator-canvas","class":"line-canvas"}).hide().appendTo(d);d.draggable({revert:!0,revertDuration:0,start:function(){c=!0,g.show(),b.dragStarted&&(b.lineColor=b.dragStarted(b.node))},drag:function(c,d){var e=d.position.left/a.zoomFactor,h=d.position.top/a.zoomFactor,j=i(b.node);k(g,b.depth+1,e,h,f,j,b.lineColor)},stop:function(e,f){c=!1,g.hide();if(b.dragStopped){var h=d.position(),i=h.left/a.zoomFactor,j=h.top/a.zoomFactor,k=f.position.left/a.zoomFactor,l=f.position.top/a.zoomFactor,m=mindmaps.Util.distance(i-k,j-l);b.dragStopped(b.node,k,l,m)}d.css({left:"",top:""})}}),this.attachToNode=function(b){if(this.node===b)return;this.node=b,d.removeClass("left right"),b.offset.x>0?d.addClass("right"):b.offset.x<0&&d.addClass("left"),this.depth=b.getDepth();var c=a.getLineWidth(this.depth+1);f.css("border-bottom-width",c);var e=i(b);d.appendTo(e)},this.detach=function(){d.detach(),this.node=null},this.isDragging=function(){return c}}var a=this,b=!1,c=new n(this),d=new m(this);d.commit=function(b,c){a.nodeCaptionEditCommitted&&a.nodeCaptionEditCommitted(b,c)};var e=mindmaps.TextMetrics,f=new mindmaps.CanvasBranchDrawer;f.beforeDraw=function(a,b,c,d){this.$canvas.attr({width:a,height:b}).css({left:c,top:d})},this.init=function(){g(),this.center();var b=this.$getDrawingArea();b.addClass("mindmap"),b.delegate("div.node-caption","mousedown",function(b){var c=$(this).parent().data("node");a.nodeMouseDown&&a.nodeMouseDown(c)}),b.delegate("div.node-caption","mouseup",function(b){var c=$(this).parent().data("node");a.nodeMouseUp&&a.nodeMouseUp(c)}),b.delegate("div.node-caption","dblclick",function(b){var c=$(this).parent().data("node");a.nodeDoubleClicked&&a.nodeDoubleClicked(c)}),b.delegate("div.node-container","mouseover",function(b){if(b.target===this){var c=$(this).data("node");a.nodeMouseOver&&a.nodeMouseOver(c)}return!1}),b.delegate("div.node-caption","mouseover",function(b){if(b.target===this){var c=$(this).parent().data("node");a.nodeCaptionMouseOver&&a.nodeCaptionMouseOver(c)}return!1}),this.$getContainer().bind("mousewheel",function(b,c){a.mouseWheeled&&a.mouseWheeled(c)})},this.clear=function(){var a=this.$getDrawingArea();a.children().remove(),a.width(0).height(0)},this.getLineWidth=function(a){return mindmaps.CanvasDrawingUtil.getLineWidth(this.zoomFactor,a)},this.drawMap=function(b){var c=(new Date).getTime(),d=this.$getDrawingArea();d.children().remove();var e=b.root,f=!1;if(f){var g=d.parent();d.detach(),a.createNode(e,d),d.appendTo(g)}else a.createNode(e,d);console.debug("draw map ms: ",(new Date).getTime()-c)},this.createNode=function(c,d,f){var g=c.getParent(),d=d||i(g),f=f||c.getDepth(),j=c.offset.x,l=c.offset.y,m=$("<div/>",{id:"node-"+c.id,"class":"node-container"}).data({node:c}).css({"font-size":c.text.font.size});m.appendTo(d);if(c.isRoot()){var n=this.getLineWidth(f);m.css("border-bottom-width",n)}if(!c.isRoot()){var o=this.getLineWidth(f),p=c.branchColor,q=o+"px solid "+p;m.css({left:this.zoomFactor*j,top:this.zoomFactor*l,"border-bottom":q}),m.one("mouseenter",function(){m.draggable({handle:"div.node-caption:first",start:function(){b=!0},drag:function(b,e){var g=e.position.left/a.zoomFactor,i=e.position.top/a.zoomFactor,j=c.branchColor,l=h(c);k(l,f,g,i,m,d,j),a.nodeDragging&&a.nodeDragging()},stop:function(d,e){b=!1;var f=new mindmaps.Point(e.position.left/a.zoomFactor,e.position.top/a.zoomFactor);a.nodeDragged&&a.nodeDragged(c,f)}})})}var r=c.text.font,s=$("<div/>",{id:"node-caption-"+c.id,"class":"node-caption node-text-behaviour",text:c.text.caption}).css({color:r.color,"font-size":this.zoomFactor*100+"%","font-weight":r.weight,"font-style":r.style,"text-decoration":r.decoration}).appendTo(m),t=e.getTextMetrics(c,this.zoomFactor);s.css(t);var u=d.data("foldButton"),v=c.isRoot()||g.isRoot();!u&&!v&&this.createFoldButton(g);if(!c.isRoot()){g.foldChildren?m.hide():m.show();var w=$("<canvas/>",{id:"node-canvas-"+c.id,"class":"line-canvas"});k(w,f,j,l,m,d,c.branchColor),w.appendTo(m)}c.isRoot()&&m.children().andSelf().addClass("root"),c.forEachChild(function(b){a.createNode(b,m,f+1)})},this.deleteNode=function(a){var b=i(a);b.remove()},this.highlightNode=function(a){var b=j(a);b.addClass("selected")},this.unhighlightNode=function(a){var b=j(a);b.removeClass("selected")},this.closeNode=function(a){var b=i(a);b.children(".node-container").hide();var c=b.children(".button-fold").first();c.removeClass("open").addClass("closed")},this.openNode=function(a){var b=i(a);b.children(".node-container").show();var c=b.children(".button-fold").first();c.removeClass("closed").addClass("open")},this.createFoldButton=function(b){var c=b.offset.x>0?" right":" left",d=b.foldChildren?" closed":" open",e=$("<div/>",{"class":"button-fold no-select"+d+c}).click(function(c){return a.foldButtonClicked&&a.foldButtonClicked(b),c.preventDefault(),!1}),f=i(b);f.data({foldButton:!0}).append(e)},this.removeFoldButton=function(a){var b=i(a);b.data({foldButton:!1}).children(".button-fold").remove()},this.editNodeCaption=function(a){d.edit(a,this.$getDrawingArea())},this.stopEditNodeCaption=function(){d.stop()},this.setNodeText=function(a,b){var c=j(a),d=e.getTextMetrics(a,this.zoomFactor,b);c.css(d).text(b)},this.getCreator=function(){return c},this.isNodeDragging=function(){return b},this.redrawNodeConnectors=function(a){a.isRoot()||l(a),a.isLeaf()||a.forEachChild(function(a){l(a)})},this.updateBranchColor=function(a,b){var c=i(a);c.css("border-bottom-color",b),a.isRoot()||l(a,b)},this.updateFontColor=function(a,b){var c=j(a);c.css("color",b)},this.updateNode=function(a){var b=i(a),c=j(a),d=a.text.font;b.css({"font-size":d.size,"border-bottom-color":a.branchColor});var f=e.getTextMetrics(a,this.zoomFactor);c.css({color:d.color,"font-weight":d.weight,"font-style":d.style,"text-decoration":d.decoration}).css(f),this.redrawNodeConnectors(a)},this.positionNode=function(a){var b=i(a);b.css({left:this.zoomFactor*a.offset.x,top:this.zoomFactor*a.offset.y}),l(a)},this.scaleMap=function(){function k(c,d){var f=i(c),g=a.getLineWidth(d);f.css({left:b*c.offset.x,top:b*c.offset.y,"border-bottom-width":g});var h=j(c);h.css({"font-size":b*100+"%"});var m=e.getTextMetrics(c,a.zoomFactor);h.css(m),l(c),c.isLeaf()||c.forEachChild(function(a){k(a,d+1)})}var b=this.zoomFactor,c=this.$getDrawingArea().children().first(),d=c.data("node"),f=this.getLineWidth(0);c.css("border-bottom-width",f);var g=j(d),h=e.getTextMetrics(d,this.zoomFactor);g.css({"font-size":b*100+"%",left:b*-mindmaps.TextMetrics.ROOT_CAPTION_MIN_WIDTH/2}).css(h),d.forEachChild(function(a){k(a,1)})}},mindmaps.DefaultCanvasView.prototype=new mindmaps.CanvasView;
mindmaps.CanvasPresenter=function(a,b,c,d,e){function j(a){d.setZoomFactor(e.DEFAULT_ZOOM);var b=a.dimensions;d.setDimensions(b.x,b.y);var f=a.mindmap;d.drawMap(f),d.center(),c.selectNode(f.root)}function k(){a.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(a,b){j(a)}),a.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(a){d.clear()}),a.subscribe(mindmaps.Event.NODE_MOVED,function(a){d.positionNode(a)}),a.subscribe(mindmaps.Event.NODE_TEXT_CAPTION_CHANGED,function(a){d.setNodeText(a,a.getCaption()),d.redrawNodeConnectors(a)}),a.subscribe(mindmaps.Event.NODE_CREATED,function(a){d.createNode(a);if(a.shouldEditCaption){delete a.shouldEditCaption;var b=a.getParent();if(b.foldChildren){var e=new mindmaps.action.OpenNodeAction(b);c.executeAction(e)}c.selectNode(a),g.attachToNode(a),d.editNodeCaption(a)}}),a.subscribe(mindmaps.Event.NODE_DELETED,function(a,b){var e=c.selectedNode;(a===e||a.isDescendant(e))&&c.selectNode(b),d.deleteNode(a),b.isLeaf()&&d.removeFoldButton(b)}),a.subscribe(mindmaps.Event.NODE_SELECTED,i),a.subscribe(mindmaps.Event.NODE_OPENED,function(a){d.openNode(a)}),a.subscribe(mindmaps.Event.NODE_CLOSED,function(a){d.closeNode(a)}),a.subscribe(mindmaps.Event.NODE_FONT_CHANGED,function(a){d.updateNode(a)}),a.subscribe(mindmaps.Event.NODE_FONT_COLOR_PREVIEW,function(a,b){d.updateFontColor(a,b)}),a.subscribe(mindmaps.Event.NODE_BRANCH_COLOR_CHANGED,function(a){d.updateNode(a)}),a.subscribe(mindmaps.Event.NODE_BRANCH_COLOR_PREVIEW,function(a,b){d.updateBranchColor(a,b)}),a.subscribe(mindmaps.Event.ZOOM_CHANGED,function(a){d.setZoomFactor(a),d.applyViewZoom(),d.scaleMap()})}var f=this,g=d.getCreator();this.init=function(){var a=b.get(mindmaps.EditNodeCaptionCommand);a.setHandler(this.editNodeCaption.bind(this));var c=b.get(mindmaps.ToggleNodeFoldedCommand);c.setHandler(h)},this.editNodeCaption=function(a){a||(a=c.selectedNode),d.editNodeCaption(a)};var h=function(a){a||(a=c.selectedNode);var b=new mindmaps.action.ToggleNodeFoldAction(a);c.executeAction(b)},i=function(a,b){b&&d.unhighlightNode(b),d.highlightNode(a)};d.mouseWheeled=function(a){d.stopEditNodeCaption(),a>0?e.zoomIn():e.zoomOut()},d.nodeMouseOver=function(a){!d.isNodeDragging()&&!g.isDragging()&&g.attachToNode(a)},d.nodeCaptionMouseOver=function(a){!d.isNodeDragging()&&!g.isDragging()&&g.attachToNode(a)},d.nodeMouseDown=function(a){c.selectNode(a),g.attachToNode(a)},d.nodeDoubleClicked=function(a){d.editNodeCaption(a)},d.nodeDragged=function(a,b){var d=new mindmaps.action.MoveNodeAction(a,b);c.executeAction(d)},d.foldButtonClicked=function(a){h(a)},g.dragStarted=function(a){var b=a.isRoot()?mindmaps.Util.randomColor():a.branchColor;return b},g.dragStopped=function(a,b,d,e){if(e<50)return;var f=new mindmaps.Node;f.branchColor=g.lineColor,f.offset=new mindmaps.Point(b,d),f.shouldEditCaption=!0,c.createNode(f,a)},d.nodeCaptionEditCommitted=function(a,b){var b=$.trim(b);if(!b)return;d.stopEditNodeCaption(),c.changeNodeCaption(a,b)},this.go=function(){d.init()},k(),this.init()};
mindmaps.ApplicationController=function(){function k(){var b=e.getDocument();m();var c=new mindmaps.NewDocumentPresenter(a,e,new mindmaps.NewDocumentView);c.go()}function l(){var b=new mindmaps.SaveDocumentPresenter(a,e,new mindmaps.SaveDocumentView,i,j);b.go()}function m(){var a=e.getDocument();a&&e.setDocument(null)}function n(){var b=new mindmaps.OpenDocumentPresenter(a,e,new mindmaps.OpenDocumentView,j);b.go()}function o(){var b=new mindmaps.ExportMapPresenter(a,e,new mindmaps.ExportMapView);b.go()}var a=new mindmaps.EventBus,b=new mindmaps.ShortcutController,c=new mindmaps.CommandRegistry(b),d=new mindmaps.UndoController(a,c),e=new mindmaps.MindMapModel(a,c,d),f=new mindmaps.ClipboardController(a,c,e),g=new mindmaps.HelpController(a,c),h=new mindmaps.PrintController(a,c,e),i=new mindmaps.AutoSaveController(a,e),j=new mindmaps.FilePicker(a,e);this.init=function(){var b=c.get(mindmaps.NewDocumentCommand);b.setHandler(k),b.setEnabled(!0);var d=c.get(mindmaps.OpenDocumentCommand);d.setHandler(n),d.setEnabled(!0);var e=c.get(mindmaps.SaveDocumentCommand);e.setHandler(l);var f=c.get(mindmaps.CloseDocumentCommand);f.setHandler(m);var g=c.get(mindmaps.ExportCommand);g.setHandler(o),a.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(){e.setEnabled(!1),f.setEnabled(!1),g.setEnabled(!1)}),a.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(){e.setEnabled(!0),f.setEnabled(!0),g.setEnabled(!0)})},this.go=function(){var b=new mindmaps.MainViewController(a,e,c);b.go(),k()},this.init()};
mindmaps.MindMapModel=function(a,b,c){var d=this;this.document=null,this.selectedNode=null,this.getDocument=function(){return this.document},this.setDocument=function(b){this.document=b,b?a.publish(mindmaps.Event.DOCUMENT_OPENED,b):a.publish(mindmaps.Event.DOCUMENT_CLOSED)},this.getMindMap=function(){return this.document?this.document.mindmap:null},this.init=function(){var c=b.get(mindmaps.CreateNodeCommand);c.setHandler(this.createNode.bind(this));var d=b.get(mindmaps.CreateSiblingNodeCommand);d.setHandler(this.createSiblingNode.bind(this));var e=b.get(mindmaps.DeleteNodeCommand);e.setHandler(this.deleteNode.bind(this)),a.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(){c.setEnabled(!1),d.setEnabled(!1),e.setEnabled(!1)}),a.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(){c.setEnabled(!0),d.setEnabled(!0),e.setEnabled(!0)})},this.deleteNode=function(a){a||(a=this.selectedNode);var b=this.getMindMap(),c=new mindmaps.action.DeleteNodeAction(a,b);this.executeAction(c)},this.createNode=function(a,b){var c=this.getMindMap();if(!a||!b){b=this.selectedNode;var d=new mindmaps.action.CreateAutoPositionedNodeAction(b,c)}else var d=new mindmaps.action.CreateNodeAction(a,b,c);this.executeAction(d)},this.createSiblingNode=function(){var a=this.getMindMap(),b=this.selectedNode,c=b.getParent();if(c===null)return;var d=new mindmaps.action.CreateAutoPositionedNodeAction(c,a);this.executeAction(d)},this.selectNode=function(b){if(b===this.selectedNode)return;var c=this.selectedNode;this.selectedNode=b,a.publish(mindmaps.Event.NODE_SELECTED,b,c)},this.changeNodeCaption=function(a,b){a||(a=this.selectedNode);var c=new mindmaps.action.ChangeNodeCaptionAction(a,b);this.executeAction(c)},this.executeAction=function(b){if(b instanceof mindmaps.action.CompositeAction){var e=this.executeAction.bind(this);b.forEachAction(e);return}var f=b.execute();if(f!==undefined&&!f)return!1;b.event&&(Array.isArray(b.event)||(b.event=[b.event]),a.publish.apply(a,b.event));if(b.undo){var g=function(){d.executeAction(b.undo())};if(b.redo)var h=function(){d.executeAction(b.redo())};c.addUndo(g,h)}},this.saveToLocalStorage=function(){var b=this.document.prepareSave(),c=mindmaps.LocalDocumentStorage.saveDocument(b);return c&&a.publish(mindmaps.Event.DOCUMENT_SAVED,b),c},this.init()};
mindmaps.NewDocumentView=function(){},mindmaps.NewDocumentPresenter=function(a,b,c){this.go=function(){var a=new mindmaps.Document;b.setDocument(a)}};
mindmaps.OpenDocumentView=function(){var a=this,b=$("#template-open").tmpl().dialog({autoOpen:!1,modal:!0,zIndex:5e3,width:550,close:function(){$(this).dialog("destroy"),$(this).remove()}}),c=$("#button-open-cloud").button().click(function(){a.openCloudButtonClicked&&a.openCloudButtonClicked()});b.find(".file-chooser input").bind("change",function(b){a.openExernalFileClicked&&a.openExernalFileClicked(b)});var d=b.find(".localstorage-filelist");d.delegate("a.title","click",function(){if(a.documentClicked){var b=$(this).tmplItem();a.documentClicked(b.data)}}).delegate("a.delete","click",function(){if(a.deleteDocumentClicked){var b=$(this).tmplItem();a.deleteDocumentClicked(b.data)}}),this.render=function(a){var c=$(".document-list",b).empty();$("#template-open-table-item").tmpl(a,{format:function(a){if(!a)return"";var b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear();return b+"/"+c+"/"+d}}).appendTo(c)},this.showOpenDialog=function(a){this.render(a),b.dialog("open")},this.hideOpenDialog=function(){b.dialog("close")},this.showCloudError=function(a){b.find(".cloud-loading").removeClass("loading"),b.find(".cloud-error").text(a)},this.showCloudLoading=function(){b.find(".cloud-error").text(""),b.find(".cloud-loading").addClass("loading")},this.hideCloudLoading=function(){b.find(".cloud-loading").removeClass("loading")}},mindmaps.OpenDocumentPresenter=function(a,b,c,d){c.openCloudButtonClicked=function(a){mindmaps.Util.trackEvent("Clicks","cloud-open"),d.open({load:function(){c.showCloudLoading()},success:function(){c.hideOpenDialog()},error:function(a){c.showCloudError(a)}})},c.openExernalFileClicked=function(d){mindmaps.Util.trackEvent("Clicks","hdd-open");var e=d.target.files,f=e[0],g=new FileReader;g.onload=function(){try{var d=mindmaps.Document.fromJSON(g.result)}catch(e){throw a.publish(mindmaps.Event.NOTIFICATION_ERROR,"File is not a valid mind map!"),new Error("Error while opening map from hdd",e)}b.setDocument(d),c.hideOpenDialog()},g.readAsText(f)},c.documentClicked=function(a){mindmaps.Util.trackEvent("Clicks","localstorage-open"),b.setDocument(a),c.hideOpenDialog()},c.deleteDocumentClicked=function(a){mindmaps.LocalDocumentStorage.deleteDocument(a);var b=mindmaps.LocalDocumentStorage.getDocuments();c.render(b)},this.go=function(){var a=mindmaps.LocalDocumentStorage.getDocuments();a.sort(mindmaps.Document.sortByModifiedDateDescending),c.showOpenDialog(a)}};
mindmaps.SaveDocumentView=function(){var a=this,b=$("#template-save").tmpl().dialog({autoOpen:!1,modal:!0,zIndex:5e3,width:550,close:function(){$(this).dialog("destroy"),$(this).remove()}}),c=$("#button-save-cloudstorage").button().click(function(){a.cloudStorageButtonClicked&&a.cloudStorageButtonClicked()}),d=$("#button-save-localstorage").button().click(function(){a.localStorageButtonClicked&&a.localStorageButtonClicked()}),e=$("#checkbox-autosave-localstorage").click(function(){a.autoSaveCheckboxClicked&&a.autoSaveCheckboxClicked($(this).prop("checked"))}),f=$("#button-save-hdd").button().click(function(){a.hddSaveButtonClicked&&a.hddSaveButtonClicked()});this.setAutoSaveCheckboxState=function(a){e.prop("checked",a)},this.showSaveDialog=function(){b.dialog("open")},this.hideSaveDialog=function(){b.dialog("close")},this.showCloudError=function(a){b.find(".cloud-error").text(a)}},mindmaps.SaveDocumentPresenter=function(a,b,c,d,e){c.cloudStorageButtonClicked=function(){mindmaps.Util.trackEvent("Clicks","cloud-save"),e.save({success:function(){c.hideSaveDialog()},error:function(a){c.showCloudError(a)}})},c.localStorageButtonClicked=function(){mindmaps.Util.trackEvent("Clicks","localstorage-save");var d=b.saveToLocalStorage();d?c.hideSaveDialog():a.publish(mindmaps.Event.NOTIFICATION_ERROR,"Error while saving to local storage")},c.autoSaveCheckboxClicked=function(a){a?d.enable():d.disable()},c.hddSaveButtonClicked=function(){mindmaps.Util.trackEvent("Clicks","hdd-save");var d=b.getMindMap().getRoot().getCaption()+".json",e=b.getDocument().prepareSave().serialize(),f=new Blob([e],{type:"text/plain;charset=utf-8"});window.saveAs(f,d);var g=b.getDocument();a.publish(mindmaps.Event.DOCUMENT_SAVED,g),c.hideSaveDialog()},this.go=function(){c.setAutoSaveCheckboxState(d.isEnabled()),c.showSaveDialog()}};
mindmaps.CanvasContainer=function(){var a=this,b=$("#canvas-container");this.getContent=function(){return b},this.setSize=function(){var c=$(window).height(),d=$("#topbar").outerHeight(!0),e=$("#bottombar").outerHeight(!0),f=c-d-e;b.height(f);var g=new mindmaps.Point(b.width(),f);a.publish(mindmaps.CanvasContainer.Event.RESIZED,g)},this.acceptFileDrop=function(){function c(a){a.originalEvent.stopPropagation(),a.originalEvent.preventDefault()}function d(a){c(a)}function e(b){c(b);var d=b.originalEvent.dataTransfer.files,e=d[0],f=new FileReader;f.onload=function(){a.receivedFileDrop(f.result)},f.readAsText(e)}b.bind("dragover",d),b.bind("drop",e)},this.init=function(){$(window).resize(function(){a.setSize()}),this.setSize(),this.acceptFileDrop()},this.receivedFileDrop=function(a){}},EventEmitter.mixin(mindmaps.CanvasContainer),mindmaps.CanvasContainer.Event={RESIZED:"ResizedEvent"},mindmaps.MainViewController=function(a,b,c){var d=new mindmaps.ZoomController(a,c),e=new mindmaps.CanvasContainer;e.receivedFileDrop=function(c){try{var d=mindmaps.Document.fromJSON(c);b.setDocument(d)}catch(e){a.publish(mindmaps.Event.NOTIFICATION_ERROR,"Could not read the file."),console.warn("Could not open the mind map via drag and drop.")}},this.go=function(){e.init();var f=new mindmaps.ToolBarView,g=new mindmaps.ToolBarPresenter(a,c,f,b);g.go();var h=new mindmaps.DefaultCanvasView,i=new mindmaps.CanvasPresenter(a,c,b,h,d);i.go();var j=new mindmaps.StatusBarView,k=new mindmaps.StatusBarPresenter(a,j);k.go();var l=new mindmaps.FloatPanelFactory(e),m=new mindmaps.InspectorView,n=new mindmaps.InspectorPresenter(a,b,m);n.go();var o=l.create("Inspector",m.getContent());o.show(),k.addEntry(o);var p=new mindmaps.NavigatorView,q=new mindmaps.NavigatorPresenter(a,p,e,d);q.go();var r=l.create("Navigator",p.getContent());r.show(),k.addEntry(r)}};
mindmaps.LocalStorage=function(){return{put:function(a,b){localStorage.setItem(a,b)},get:function(a){return localStorage.getItem(a)},clear:function(){localStorage.clear()}}}(),mindmaps.SessionStorage=function(){return{put:function(a,b){sessionStorage.setItem(a,b)},get:function(a){return sessionStorage.getItem(a)},clear:function(){sessionStorage.clear()}}}(),mindmaps.LocalDocumentStorage=function(){var a="mindmaps.document.",b=function(a){var b=localStorage.getItem(a);if(b===null)return null;try{return mindmaps.Document.fromJSON(b)}catch(c){return console.error("Error while loading document from local storage",c),null}};return{saveDocument:function(b){try{return localStorage.setItem(a+b.id,b.serialize()),!0}catch(c){return console.error("Error while saving document to local storage",c),!1}},loadDocument:function(c){return b(a+c)},getDocuments:function(){var c=[];for(var d=0,e=localStorage.length;d<e;d++){var f=localStorage.key(d);if(f.indexOf(a)==0){var g=b(f);g&&c.push(g)}}return c},getDocumentIds:function(){var b=[];for(var c=0,d=localStorage.length;c<d;c++){var e=localStorage.key(c);e.indexOf(a)==0&&b.push(e.substring(a.length))}return b},deleteDocument:function(b){localStorage.removeItem(a+b.id)},deleteAllDocuments:function(){this.getDocuments().forEach(this.deleteDocument)}}}();
mindmaps.Event={DOCUMENT_OPENED:"DocumentOpenedEvent",DOCUMENT_SAVED:"DocumentSavedEvent",DOCUMENT_CLOSED:"DocumentClosedEvent",NODE_SELECTED:"NodeSelectedEvent",NODE_DESELECTED:"NodeDeselectedEvent",NODE_MOVED:"NodeMovedEvent",NODE_TEXT_CAPTION_CHANGED:"NodeTextCaptionChangedEvent",NODE_FONT_CHANGED:"NodeFontChangedEvent",NODE_FONT_COLOR_PREVIEW:"NodeFontColorPreviewEvent",NODE_BRANCH_COLOR_CHANGED:"NodeBranchColorChangedEvent",NODE_BRANCH_COLOR_PREVIEW:"NodeBranchColorPreviewEvent",NODE_CREATED:"NodeCreatedEvent",NODE_DELETED:"NodeDeletedEvent",NODE_OPENED:"NodeOpenedEvent",NODE_CLOSED:"NodeClosedEvent",ZOOM_CHANGED:"ZoomChangedEvent",NOTIFICATION_INFO:"NotificationInfoEvent",NOTIFICATION_WARN:"NotificationWarnEvent",NOTIFICATION_ERROR:"NotificationErrorEvent"},mindmaps.EventBus=EventEmitter;if(mindmaps.DEBUG){var old=mindmaps.EventBus.prototype.emit;mindmaps.EventBus.prototype.publish=function(a){var b=this.listeners(a).length;console.log("EventBus > publish: "+a,"(Listeners: "+b+")"),old.apply(this,arguments)}};
mindmaps.Notification=function(a,b){var c=this;b=$.extend({},mindmaps.Notification.Defaults,b);var d=this.$el=$("#template-notification").tmpl(b).css({"max-width":b.maxWidth}).addClass(b.type),e=$(a);if(e.length===0)return this;var f=e.offset(),g=f.left,h=f.top,i=e.outerWidth(),j=e.outerHeight();d.appendTo($("body"));var k=d.outerWidth(),l=d.outerHeight(),m,n,o=b.padding;switch(b.position){case"topLeft":n=h-o-l,m=g;break;case"topMiddle":n=h-o-l,k<i?m=g+(i-k)/2:m=g-(k-i)/2;break;case"topRight":n=h-o-l,m=g+i-k;break;case"rightTop":n=h;break;case"rightMiddle":l<j?n=h+(j-l)/2:n=h-(l-j)/2,m=g+o+i;break;case"rightBottom":n=h+j-l,m=g+o+i;break;case"bottomLeft":n=h+o+j,m=g;break;case"bottomMiddle":n=h+o+j,k<i?m=g+(i-k)/2:m=g-(k-i)/2;break;case"bottomRight":n=h+o+j,m=g+i-k;break;case"leftTop":n=h,m=g-o-k;break;case"leftMiddle":l<j?n=h+(j-l)/2:n=h-(l-j)/2,m=g-o-k;break;case"leftBottom":n=h+j-l,m=g-o-k}d.offset({left:m,top:n}),b.expires&&setTimeout(function(){c.close()},b.expires),b.closeButton&&d.find(".close-button").click(function(){c.close()}),d.fadeIn(600)},mindmaps.Notification.prototype={close:function(){var a=this.$el;a.fadeOut(800,function(){a.remove(),this.removed=!0})},isVisible:function(){return!this.removed},$:function(){return this.$el}},mindmaps.Notification.Defaults={title:null,content:"New Notification",position:"topLeft",padding:10,expires:0,closeButton:!1,maxWidth:500,type:"info"};
mindmaps.StaticCanvasRenderer=function(){function g(a,c){e.save(),f.render(e,a.getDepth(),a.offset.x,a.offset.y,a,c,a.branchColor,b),e.restore()}function h(c){function e(c){var d=mindmaps.CanvasDrawingUtil.getLineWidth(b,c.getDepth()),f=mindmaps.TextMetrics.getTextMetrics(c,b),g={lineWidth:d,textMetrics:f,width:function(){return c.isRoot()?0:f.width},innerHeight:function(){return f.height+a},outerHeight:function(){return f.height+d+a}};$.extend(c,g),c.forEachChild(function(a){e(a)})}var d=c.getRoot().clone();return e(d),d}function i(a){function h(a){var b=a.getPosition(),g=a.textMetrics;b.x<c&&(c=b.x),b.x+g.width>e&&(e=b.x+g.width),b.y<d&&(d=b.y),b.y+a.outerHeight()>f&&(f=b.y+a.outerHeight())}var b=a.getPosition(),c=0,d=0,e=0,f=0,g=50;h(a),a.forEachDescendant(function(a){h(a)});var i=Math.max(Math.abs(e),Math.abs(c)),j=Math.max(Math.abs(f),Math.abs(d));return{width:2*i+g,height:2*j+g}}function j(b){function m(b,c){e.save();var d=b.offset.x,f=b.offset.y;e.translate(d,f),c&&g(b,c);if(!b.isRoot()){e.fillStyle=b.branchColor;var h=b.textMetrics;e.fillRect(0,h.height+a,h.width,b.lineWidth)}b.forEachChild(function(a){m(a,b)}),e.restore()}function n(a){function j(a){var b=e.measureText(a);return b.width<=d.width}e.save();var b=a.offset.x,c=a.offset.y;e.translate(b,c);var d=a.textMetrics,f=a.getCaption(),g=a.text.font;e.font=g.style+" "+g.weight+" "+g.size+"px sans-serif";var h=d.width/2,i=0;a.isRoot()&&(h=0,i=20,e.lineWidth=5,e.strokeStyle="orange",e.fillStyle="white",mindmaps.CanvasDrawingUtil.roundedRect(e,0-d.width/2-4,16,d.width+8,d.height+8,10)),e.strokeStyle=g.color,e.fillStyle=g.color;if(j(f))e.fillText(f,h,i);else{var k=/[^ ]+ */gi,l=f.match(k);console.log("words1",l);var m=[];l.forEach(function(a){if(!j(a)){var b="";for(var c=0;c<a.length;c++){var d=a.charAt(c);if(j(b+d)){b+=d;continue}m.push(b),b=d}m.push(b)}else m.push(a)}),console.log("words2",m);var o=function(a){return e.measureText(a).width},p=[],q="",r=d.width;m.forEach(function(a){q===""?q=a:o(q+" "+a)>r?(p.push(q),q=a):q+=" "+a}),p.push(q),console.log("lines",p);for(var s=0;s<p.length;s++){var q=p[s];e.fillText(q,h,i+s*g.size)}}a.forEachChild(function(a){n(a)}),e.restore()}var c=b.mindmap,f=h(c),j=i(f),k=j.width,l=j.height;d.attr({width:k,height:l}),e.textBaseline="top",e.textAlign="center",e.fillStyle="white",e.fillRect(0,0,k,l),e.translate(k/2,l/2),m(f),n(f)}var a=8,b=1,c=this,d=$("<canvas/>",{"class":"map"}),e=d[0].getContext("2d"),f=new mindmaps.CanvasBranchDrawer;f.beforeDraw=function(a,b,c,d){e.translate(c,d)},this.getImageData=function(a){return j(a),d[0].toDataURL("image/png")},this.renderAsPNG=function(a){var b=this.getImageData(a),c=$("<img/>",{src:b,"class":"map"});return c},this.renderAsCanvas=function(a){return j(a),d}};
mindmaps.PrintController=function(a,b,c){function f(){var a=e.renderAsPNG(c.getDocument());$("#print-area").html(a),window.print()}var d=b.get(mindmaps.PrintCommand);d.setHandler(f);var e=new mindmaps.StaticCanvasRenderer;a.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(){d.setEnabled(!1)}),a.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(){d.setEnabled(!0)})};
mindmaps.ExportMapView=function(){var a=this,b=$("#template-export-map").tmpl().dialog({autoOpen:!1,modal:!0,zIndex:5e3,width:"auto",height:"auto",close:function(){$(this).dialog("destroy"),$(this).remove()},open:function(){$(this).css({"max-width":$(window).width()*.9,"max-height":$(window).height()*.8}),b.dialog("option","position","center")},buttons:{Ok:function(){$(this).dialog("close")}}});this.showDialog=function(){b.dialog("open")},this.hideDialog=function(){b.dialog("close")},this.setImage=function(a){$("#export-preview").html(a)}},mindmaps.ExportMapPresenter=function(a,b,c){var d=new mindmaps.StaticCanvasRenderer;this.go=function(){var a=d.renderAsPNG(b.getDocument());c.setImage(a),setTimeout(function(){c.showDialog()},30)}};
mindmaps.AutoSaveController=function(a,b){function e(){console.debug("Autosaving..."),b.saveToLocalStorage()}function f(){d||(d=setInterval(e,c))}function g(){d&&(clearInterval(d),d=null)}var c=6e4,d=null;this.enable=function(){f(),b.getDocument().setAutoSave(!0)},this.disable=function(){g(),b.getDocument().setAutoSave(!1)},this.isEnabled=function(){return b.getDocument().isAutoSave()},this.init=function(){a.subscribe(mindmaps.Event.DOCUMENT_OPENED,this.documentOpened.bind(this)),a.subscribe(mindmaps.Event.DOCUMENT_CLOSED,this.documentClosed.bind(this))},this.documentOpened=function(a){this.isEnabled()&&f()},this.documentClosed=function(){g()},this.init()};
mindmaps.FilePicker=function(a,b){if(window.filepicker){var c=window.filepicker;c.setKey("P9tQ4bicRwyIe8ZUsny5");var d="application/json",e={modal:!0,services:[c.SERVICES.GOOGLE_DRIVE,c.SERVICES.DROPBOX,c.SERVICES.BOX,c.SERVICES.URL]},f={modal:!0,services:[c.SERVICES.GOOGLE_DRIVE,c.SERVICES.DROPBOX,c.SERVICES.BOX]}}this.open=function(f){f=f||{};if(!c||!navigator.onLine){f.error&&f.error("Cannot access cloud, it appears you are offline.");return}c.getFile(d,e,function(c,d){f.load&&f.load(),$.ajax({url:c,success:function(c){try{Object.prototype.toString.call(c)=="[object String]"&&(c=JSON.parse(c));var d=mindmaps.Document.fromObject(c)}catch(e){throw a.publish(mindmaps.Event.NOTIFICATION_ERROR,"File is not a valid mind map!"),new Error("Error while parsing map from cloud",e)}b.setDocument(d),f.success&&f.success(d)},error:function(a,b,c){throw f.error&&f.error("Error: Could not open mind map!"),new Error("Error while loading map from filepicker. "+b+" "+c)}})})},this.save=function(e){e=e||{};if(!c||!navigator.onLine){e.error&&e.error("Cannot access cloud, it appears you are offline.");return}var g=b.getDocument(),h=g.prepareSave().serialize(),i=function(b){console.log("saved to:",b),a.publish(mindmaps.Event.DOCUMENT_SAVED,g),e.success&&e.success()};c.getUrlFromData(h,function(a){c.saveAs(a,d,f,i)})}};